pre_election_effects = {
	set_old_election_results = yes
	hidden_effect = {
		meta_effect = {
			text = {
				set_politics = {
					ruling_party = [RULINGPARTY]
					last_election = [TODAY]
					elections_allowed = yes
				}
			}
			RULINGPARTY = "[?ROOT.current_party_ideology_group.GetTokenKey]"
			TODAY = "[?global.date.GetDateStringNoHour]"
			debug = yes
		}
		remove_ideas = unstable_coalition
	}
	if = {
		limit = {
			has_idea = presidential_republic
		}
		country_event = election.1
	}
	if = {
		limit = {
			has_idea = parliamentary_system
		}
		country_event = election.3
	}
	if = {
		limit = {
			has_idea = demarchic_republic
		}
		country_event = election.4
	}
}

post_election_effects = {
	set_parliament_graphics = yes
	add_timed_idea = { idea = electoral_honeymoon days = 30 }
	if = {
		limit = {
			has_idea = federal
		}
		country_event = election.7
	}
	if = {
	    limit = {
		    original_tag = DEU
			has_global_flag = akk_elected
		}
		clr_global_flag = akk_elected
		create_country_leader = {
	        name = "Annegret Kramp-Karrenbauer"
	        picture = "Annegret_Kramp_Karrenbauer.dds"
	        ideology = christian_democrat
        }
    }
	if = {
	    limit = {
			original_tag = DEU
			has_global_flag = merz_elected
		}
		clr_global_flag = merz_elected
		create_country_leader = {
	        name = "Friedrich Merz"
	        picture = "Friedrich_Merz.dds"
	        ideology = christian_democrat
			traits = {
				friend_of_america
			}
        }
	}
	if = {
	    limit = {
		    original_tag = NRU
			has_government = social_liberal
	    }
		country_event = nauru.1
	}
	if = {
	    limit = {
		    original_tag = ITA
			has_government = classical_liberal
			has_country_flag = coalition_right_wing_populist
			NOT = {
				has_country_leader = {
					name = "Giuseppe Conte"
					ruling_only = no
				}
			}
		}
		country_event = italy.1
	}
	if = {
	    limit = {
		    original_tag = THA
			NOT = { has_global_flag = palang_pracharath_flag }
	    }
		set_global_flag = palang_pracharath_flag
		set_party_name = {
		    ideology = national_conservative
		    long_name = THA_national_conservative_party_PPP_long
		    name = THA_national_conservative_party_PPP
	    }
	}
	if = {
	    limit = {
		    original_tag = MMR
			has_government = social_democrat
			NOT = { has_global_flag = myanmar_coup }
		}
	    set_global_flag = myanmar_coup
		hidden_effect = {
			country_event = { 
				id = myanmar.1
				days = 85
			}
		}
	}
	if = {
	    limit = {
			original_tag = ADO
		    has_country_leader = {
				name = "Antoni Martí"
				ruling_only = yes
			}
		}
		retire_ideology_leader = conservative
		create_country_leader = {
	        name = "Xavier Espot"
	        picture = GFX_Portrait_ADO_Xavier_Espot
	        ideology = liberal_conservative
        }
	}
	if  = {
		limit = {
			original_tag = CHE
			has_country_leader = {
				name = "Alain Berset"
				ruling_only = no
			}
		}
		retire_ideology_leader = social_democrat
		create_country_leader = {
			name = "Simonetta Sommaruga"
			picture = GFX_Portrait_CHE_Simonetta_Sommaruga
			ideology = social_democrat_ideology
		}
	}
	if  = {
		limit = {
			original_tag = CHE
			has_country_leader = {
				name = "Ueli Maurer"
				ruling_only = no
			}
		}
		retire_ideology_leader = national_conservative
		create_country_leader = {
			name = "Guy Parmelin"
			picture = GFX_Portrait_CHE_Guy_Parmelin
			ideology = national_conservative_ideology
		}
	}
	if  = {
		limit = {
			original_tag = ENG
			NOT = { has_government = social_democrat }
			has_country_leader = {
				name = "Jeremy Corbyn"
				ruling_only = no
			}
		}
		country_event = britain.8
	}
	if  = {
		limit = {
			original_tag = CRI
			has_country_leader = {
				name = "Luis Guillermo Solís"
				ruling_only = no
			}
		}
		retire_ideology_leader = social_democrat
		create_country_leader = {
			name = "Carlos Alvarado Quesada"
			picture = GFX_Portrait_CRI_Carlos_Alvarado_Quesada
			ideology = social_democrat_ideology
		}
	}
	if  = {
		limit = {
			original_tag = DZA
			has_country_flag = bouteflika_not_running
		}
		clr_country_flag = bouteflika_not_running
		retire_ideology_leader = socialist
		create_country_leader = {
			name = "Abdelmadjid Tebboune"
			picture = GFX_Portrait_DZA_Abdelmadjid_Tebboune
			ideology = arab_socialist
		}
	}
	if  = {
		limit = {
			original_tag = ITA
			has_country_leader = {
				name = "Paolo Gentiloni"
				ruling_only = yes
			}
		}
		retire_ideology_leader = social_democrat
		create_country_leader = {
			name = "Matteo Renzi"
			picture = GFX_Portrait_ITA_Matteo_Renzi
			ideology = social_democrat_ideology
		}
		else = {
			if = {
				limit = {
					original_tag = ITA
					has_country_leader = {
						name = "Paolo Gentiloni"
						ruling_only = no
					}
				}
				retire_ideology_leader = social_democrat
				create_country_leader = {
					name = "Maurizio Martina"
					picture = GFX_Portrait_ITA_Maurizio_Martina
					ideology = social_democrat_ideology
				}
			}
		}
	}
	if  = {
		limit = {
			original_tag = KOR
			has_country_leader = {
				name = "Moon Jae-in"
				ruling_only = no
			}
		}
		retire_ideology_leader = social_liberal
		create_country_leader = {
			name = "Lee Jae-myung"
			picture = GFX_Portrait_KOR_Lee_Jae_myung
			ideology = social_liberal_ideology
		}
	}
	if  = {
		limit = {
			original_tag = ISR
			social_democrat < 0.1
			has_country_leader = {
				name = "Avi Gabbay"
				ruling_only = no
			}
		}
		country_event = israel.2
	}
	if  = {
		limit = {
			original_tag = TKM
			has_country_leader = {
				name = "Gurbanguly Berdimuhamedow"
				ruling_only = no
			}
		}
		retire_ideology_leader = national_conservative
		create_country_leader = {
			name = "Serdar Berdimuhamedow"
			picture = GFX_Portrait_TKM_Serdar_Berdimuhamedow
			ideology = national_conservative_ideology
		}
	}
	if  = {
		limit = {
			original_tag = SLE
			has_country_leader = {
				name = "Ernest Bai Koroma"
				ruling_only = yes
			}
		}
		retire_ideology_leader = socialist
		create_country_leader = {
			name = "Samura Kamara"
			picture = GFX_Portrait_SLE_Samura_Kamara
			ideology = democratic_socialist
		}
	}
	if  = {
		limit = {
			original_tag = MEX
			has_country_leader = {
				name = "Enrique Peña Nieto"
				ruling_only = yes
			}
		}
		retire_ideology_leader = classical_liberal
		create_country_leader = {
			name = "José Antonio Meade"
			picture = GFX_Portrait_MEX_Jose_Antonio_Meade
			ideology = classical_liberal_ideology
		}
	}
	if  = {
		limit = {
			original_tag = JEY
			has_country_leader = {
				name = "Ian Gorst"
				ruling_only = no
			}
		}
		retire_ideology_leader = classical_liberal
		create_country_leader = {
			name = "John Le Fondré"
			picture = GFX_Portrait_JEY_John_Le_Fondre
			ideology = classical_liberal_ideology
		}
	}
	if  = {
		limit = {
			original_tag = CAN
			NOT = { has_government = conservative }
			has_country_leader = {
				name = "Andrew Scheer"
				ruling_only = no
			}
		}
		country_event = canada.1
	}
	if  = {
		limit = {
			original_tag = PAK
			has_country_leader = {
				name = "Shahid Khaqan Abbasi"
				ruling_only = no
			}
		}
		retire_ideology_leader = conservative
		create_country_leader = {
			name = "Shehbaz Sharif"
			picture = GFX_Portrait_PAK_Shehbaz_Sharif
			ideology = liberal_conservative
		}
	}
	if  = {
		limit = {
			original_tag = BRA
			has_country_leader = {
				name = "Michel Temer"
				ruling_only = no
			}
		}
		retire_ideology_leader = classical_liberal
		create_country_leader = {
			name = "Henrique Meirelles"
			picture = GFX_Portrait_BRA_Henrique_Meirelles
			ideology = classical_liberal_ideology
		}
	}
	if  = {
		limit = {
			original_tag = PRY
			has_country_leader = {
				name = "Horacio Cartes"
				ruling_only = no
			}
		}
		retire_ideology_leader = national_conservative
		create_country_leader = {
			name = "Mario Abdo Benítez"
			picture = GFX_Portrait_PRY_Mario_Abdo_Benitez
			ideology = national_conservative_ideology
		}
	}
	if  = {
		limit = {
			original_tag = AUS
			NOT = { has_government = social_democrat }
			has_country_leader = {
				name = "Bill Shorten"
				ruling_only = no
			}
		}
		country_event = australia.4
	}
	if  = {
		limit = {
			original_tag = URY
			has_country_leader = {
				name = "Tabaré Vázquez"
				ruling_only = no
			}
		}
		retire_ideology_leader = socialist
		create_country_leader = {
			name = "Daniel Martínez"
			picture = GFX_Portrait_URY_Daniel_Martinez
			ideology = socialism_of_the_21st_century
		}
	}
	if  = {
		limit = {
			original_tag = SLV
			has_country_leader = {
				name = "Salvador Sánchez Cerén"
				ruling_only = no
			}
		}
		retire_ideology_leader = socialist
		create_country_leader = {
			name = "Hugo Martínez"
			picture = GFX_Portrait_SLV_Hugo_Martinez
			ideology = socialism_of_the_21st_century
		}
	}
	if  = {
		limit = {
			original_tag = GNB
			has_country_leader = {
				name = "José Mário Vaz"
				ruling_only = no
			}
		}
		retire_ideology_leader = socialist
		create_country_leader = {
			name = "Domingos Simões Pereira"
			picture = GFX_Portrait_GNB_Domingos_Simoes_Pereira
			ideology = left_wing_nationalist
		}
	}
	if = {
		limit = {
			minority_government = yes
		}
		hidden_effect = {
			add_ideas = minority_government
		}
	}
	set_election_change = yes
	news_event = election.8
}

break_coalition = {
	clr_country_flag = coalition_islamist
	clr_country_flag = coalition_fascist
	clr_country_flag = coalition_right_wing_populist
	clr_country_flag = coalition_monarchist
	clr_country_flag = coalition_national_conservative
	clr_country_flag = coalition_conservative
	clr_country_flag = coalition_classical_liberal
	clr_country_flag = coalition_social_liberal
	clr_country_flag = coalition_social_democrat
	clr_country_flag = coalition_progressive
	clr_country_flag = coalition_socialist
	clr_country_flag = coalition_communist
	clear_variable = ROOT.Coalition
}

cleanup_coalition = {
	clr_country_flag = government_chosen
	clr_country_flag = government_islamist
	clr_country_flag = government_fascist
	clr_country_flag = government_right_wing_populist
	clr_country_flag = government_monarchist
	clr_country_flag = government_national_conservative
	clr_country_flag = government_conservative
	clr_country_flag = government_classical_liberal
	clr_country_flag = government_social_liberal
	clr_country_flag = government_social_democrat
	clr_country_flag = government_progressive
	clr_country_flag = government_socialist
	clr_country_flag = government_communist
	clr_country_flag = coalition_chosen
	clear_variable = ROOT.NewCoalition
	clear_variable = ROOT.NewCoalitionLeader
	clear_variable = ROOT.NewCoalitionPartner
}

cleanup_seats_parliament = {
	clear_variable = islamist_seats_parliament
	clear_variable = fascist_seats_parliament
	clear_variable = right_wing_populist_seats_parliament
	clear_variable = monarchist_seats_parliament
	clear_variable = national_conservative_seats_parliament
	clear_variable = conservative_seats_parliament
	clear_variable = classical_liberal_seats_parliament
	clear_variable = social_liberal_seats_parliament
	clear_variable = social_democrat_seats_parliament
	clear_variable = progressive_seats_parliament
	clear_variable = socialist_seats_parliament
	clear_variable = communist_seats_parliament
}

update_coalition = {
	set_variable = {
		var = ROOT.Coalition
		value = 0
	}
	if = {
		limit = {
			has_country_flag = coalition_islamist
		}
		add_to_variable = { ROOT.Coalition = islamist_seats }
	}
	if = {
		limit = {
			has_country_flag = coalition_fascist
		}
		add_to_variable = { ROOT.Coalition = fascist_seats }
	}
	if = {
		limit = {
			has_country_flag = coalition_right_wing_populist
		}
		add_to_variable = { ROOT.Coalition = right_wing_populist_seats }
	}
	if = {
		limit = {
			has_country_flag = coalition_monarchist
		}
		add_to_variable = { ROOT.Coalition = monarchist_seats }
	}
	if = {
		limit = {
			has_country_flag = coalition_national_conservative
		}
		add_to_variable = { ROOT.Coalition = national_conservative_seats }
	}
	if = {
		limit = {
			has_country_flag = coalition_conservative
		}
		add_to_variable = { ROOT.Coalition = conservative_seats }
	}
	if = {
		limit = {
			has_country_flag = coalition_classical_liberal
		}
		add_to_variable = { ROOT.Coalition = classical_liberal_seats }
	}
	if = {
		limit = {
			has_country_flag = coalition_social_liberal
		}
		add_to_variable = { ROOT.Coalition = social_liberal_seats }
	}
	if = {
		limit = {
			has_country_flag = coalition_social_democrat
		}
		add_to_variable = { ROOT.Coalition = social_democrat_seats }
	}
	if = {
		limit = {
			has_country_flag = coalition_progressive
		}
		add_to_variable = { ROOT.Coalition = progressive_seats }
	}
	if = {
		limit = {
			has_country_flag = coalition_socialist
		}
		add_to_variable = { ROOT.Coalition = socialist_seats }
	}
	if = {
		limit = {
			has_country_flag = coalition_communist
		}
		add_to_variable = { ROOT.Coalition = communist_seats }
	}
	if = {
		limit = {
			NOT = { has_country_flag = has_a_legislature }
		}
		break_coalition = yes
	}
	create_pie_chart = yes
}

setup_coalition = {
	# First the Leaders
	clear_array = coalition_leaders_array
	if = {
		limit = {
			check_variable = {
				communist_seats > 0.99
			}
		}
		add_to_array = {
			coalition_leaders_array = 1
		}
	}
	if = {
		limit = {
			check_variable = {
				socialist_seats > 0.99
			}
		}
		add_to_array = {
			coalition_leaders_array = 2
		}
	}
	if = {
		limit = {
			check_variable = {
				social_democrat_seats > 0.99
			}
		}
		add_to_array = {
			coalition_leaders_array = 3
		}
	}
	if = {
		limit = {
			check_variable = {
				progressive_seats > 0.99
			}
		}
		add_to_array = {
			coalition_leaders_array = 4
		}
	}
	if = {
		limit = {
			check_variable = {
				social_liberal_seats > 0.99
			}
		}
		add_to_array = {
			coalition_leaders_array = 5
		}
	}
	if = {
		limit = {
			check_variable = {
				classical_liberal_seats > 0.99
			}
		}
		add_to_array = {
			coalition_leaders_array = 6
		}
	}
	if = {
		limit = {
			check_variable = {
				conservative_seats > 0.99
			}
		}
		add_to_array = {
			coalition_leaders_array = 7
		}
	}
	if = {
		limit = {
			check_variable = {
				national_conservative_seats > 0.99
			}
		}
		add_to_array = {
			coalition_leaders_array = 8
		}
	}
	if = {
		limit = {
			check_variable = {
				right_wing_populist_seats > 0.99
			}
		}
		add_to_array = {
			coalition_leaders_array = 9
		}
	}
	if = {
		limit = {
			check_variable = {
				fascist_seats > 0.99
			}
		}
		add_to_array = {
			coalition_leaders_array = 10
		}
	}
	if = {
		limit = {
			check_variable = {
				islamist_seats > 0.99
			}
		}
		add_to_array = {
			coalition_leaders_array = 11
		}
	}
	#Then potential partners. Both are separated because the arrays get modified
	clear_array = coalition_partners_array
	if = {
		limit = {
			check_variable = {
				communist_seats > 0.99
			}
		}
		add_to_array = {
			coalition_partners_array = 1
		}
	}
	if = {
		limit = {
			check_variable = {
				socialist_seats > 0.99
			}
		}
		add_to_array = {
			coalition_partners_array = 2
		}
	}
	if = {
		limit = {
			check_variable = {
				social_democrat_seats > 0.99
			}
		}
		add_to_array = {
			coalition_partners_array = 3
		}
	}
	if = {
		limit = {
			check_variable = {
				progressive_seats > 0.99
			}
		}
		add_to_array = {
			coalition_partners_array = 4
		}
	}
	if = {
		limit = {
			check_variable = {
				social_liberal_seats > 0.99
			}
		}
		add_to_array = {
			coalition_partners_array = 5
		}
	}
	if = {
		limit = {
			check_variable = {
				classical_liberal_seats > 0.99
			}
		}
		add_to_array = {
			coalition_partners_array = 6
		}
	}
	if = {
		limit = {
			check_variable = {
				conservative_seats > 0.99
			}
		}
		add_to_array = {
			coalition_partners_array = 7
		}
	}
	if = {
		limit = {
			check_variable = {
				national_conservative_seats > 0.99
			}
		}
		add_to_array = {
			coalition_partners_array = 8
		}
	}
	if = {
		limit = {
			check_variable = {
				right_wing_populist_seats > 0.99
			}
		}
		add_to_array = {
			coalition_partners_array = 9
		}
	}
	if = {
		limit = {
			check_variable = {
				fascist_seats > 0.99
			}
		}
		add_to_array = {
			coalition_partners_array = 10
		}
	}
	if = {
		limit = {
			check_variable = {
				islamist_seats > 0.99
			}
		}
		add_to_array = {
			coalition_partners_array = 11
		}
	}
}

update_coalition_majority_gfx = {
	set_variable = {
		ROOT.MajorityGFX = ROOT.NewCoalition
	}
	divide_variable = { ROOT.MajorityGFX = 100 }
	multiply_variable = { ROOT.MajorityGFX = 230 }

	set_variable = {
		ROOT.Opposition = 100
	}
	subtract_from_variable = {
		ROOT.Opposition = ROOT.NewCoalition
	}
}

elect_new_parliament = {
	hidden_effect = {
		set_variable = { communist_election_votes = party_popularity@communist }
		multiply_variable = { communist_election_votes = 100 }
		set_variable = { socialist_election_votes = party_popularity@socialist }
		multiply_variable = { socialist_election_votes = 100 }
		set_variable = { progressive_election_votes = party_popularity@progressive }
		multiply_variable = { progressive_election_votes = 100 }
		set_variable = { social_democrat_election_votes = party_popularity@social_democrat }
		multiply_variable = { social_democrat_election_votes = 100 }
		set_variable = { social_liberal_election_votes = party_popularity@social_liberal }
		multiply_variable = { social_liberal_election_votes = 100 }
		set_variable = { classical_liberal_election_votes = party_popularity@classical_liberal }
		multiply_variable = { classical_liberal_election_votes = 100 }
		set_variable = { conservative_election_votes = party_popularity@conservative }
		multiply_variable = { conservative_election_votes = 100 }
		set_variable = { national_conservative_election_votes = party_popularity@national_conservative }
		multiply_variable = { national_conservative_election_votes = 100 }
		set_variable = { monarchist_election_votes = party_popularity@monarchist }
		multiply_variable = { monarchist_election_votes = 100 }
		set_variable = { right_wing_populist_election_votes = party_popularity@right_wing_populist }
		multiply_variable = { right_wing_populist_election_votes = 100 }
		set_variable = { fascist_election_votes = party_popularity@fascist }
		multiply_variable = { fascist_election_votes = 100 }
		set_variable = { islamist_election_votes = party_popularity@islamist }
		multiply_variable = { islamist_election_votes = 100 }
		set_variable = { communist_temp_popularity = party_popularity@communist }
		set_variable = { socialist_temp_popularity = party_popularity@socialist }
		set_variable = { progressive_temp_popularity = party_popularity@progressive }
		set_variable = { social_democrat_temp_popularity = party_popularity@social_democrat }
		set_variable = { social_liberal_temp_popularity = party_popularity@social_liberal }
		set_variable = { classical_liberal_temp_popularity = party_popularity@classical_liberal }
		set_variable = { conservative_temp_popularity = party_popularity@conservative }
		set_variable = { national_conservative_temp_popularity = party_popularity@national_conservative }
		set_variable = { monarchist_temp_popularity = party_popularity@monarchist }
		set_variable = { right_wing_populist_temp_popularity = party_popularity@right_wing_populist }
		set_variable = { fascist_temp_popularity = party_popularity@fascist }
		set_variable = { islamist_temp_popularity = party_popularity@islamist }
		if = {
			limit = {
				OR = {
					AND = {
						has_idea = threshold_one_percent
						check_variable = { communist_temp_popularity < 0.01 }
					}
					AND = {
						has_idea = threshold_two_percent
						check_variable = { communist_temp_popularity < 0.02 }
					}
					AND = {
						has_idea = threshold_three_percent
						check_variable = { communist_temp_popularity < 0.03 }
					}
					AND = {
						has_idea = threshold_four_percent
						check_variable = { communist_temp_popularity < 0.04 }
					}
					AND = {
						has_idea = threshold_five_percent
						check_variable = { communist_temp_popularity < 0.05 }
					}
					AND = {
						has_idea = threshold_six_percent
						check_variable = { communist_temp_popularity < 0.06 }
					}
					AND = {
						has_idea = threshold_seven_percent
						check_variable = { communist_temp_popularity < 0.07 }
					}
					AND = {
						has_idea = threshold_eight_percent
						check_variable = { communist_temp_popularity < 0.08 }
					}
				}
			}
			add_popularity = { ideology = communist popularity = -1 }
			set_variable = { communist_seats = 0 }
		}
		else = {
			set_variable = { communist_seats = party_popularity@communist }
			multiply_variable = { communist_seats = 100 }
			round_variable = communist_seats
			set_variable = { communist_temp_popularity = 0 }
		}
		if = {
			limit = {
				OR = {
					AND = {
						has_idea = threshold_one_percent
						check_variable = { socialist_temp_popularity < 0.01 }
					}
					AND = {
						has_idea = threshold_two_percent
						check_variable = { socialist_temp_popularity < 0.02 }
					}
					AND = {
						has_idea = threshold_three_percent
						check_variable = { socialist_temp_popularity < 0.03 }
					}
					AND = {
						has_idea = threshold_four_percent
						check_variable = { socialist_temp_popularity < 0.04 }
					}
					AND = {
						has_idea = threshold_five_percent
						check_variable = { socialist_temp_popularity < 0.05 }
					}
					AND = {
						has_idea = threshold_six_percent
						check_variable = { socialist_temp_popularity < 0.06 }
					}
					AND = {
						has_idea = threshold_seven_percent
						check_variable = { socialist_temp_popularity < 0.07 }
					}
					AND = {
						has_idea = threshold_eight_percent
						check_variable = { socialist_temp_popularity < 0.08 }
					}
				}
			}
			add_popularity = {	ideology = socialist popularity = -1 }
			set_variable = { socialist_seats = 0 }
		}
		else = {
			set_variable = { socialist_seats = party_popularity@socialist }
			multiply_variable = { socialist_seats = 100 }
			round_variable = socialist_seats
			set_variable = { socialist_temp_popularity = 0 }
		}
		if = {
			limit = {
				OR = {
					AND = {
						has_idea = threshold_one_percent
						check_variable = { progressive_temp_popularity < 0.01 }
					}
					AND = {
						has_idea = threshold_two_percent
						check_variable = { progressive_temp_popularity < 0.02 }
					}
					AND = {
						has_idea = threshold_three_percent
						check_variable = { progressive_temp_popularity < 0.03 }
					}
					AND = {
						has_idea = threshold_four_percent
						check_variable = { progressive_temp_popularity < 0.04 }
					}
					AND = {
						has_idea = threshold_five_percent
						check_variable = { progressive_temp_popularity < 0.05 }
					}
					AND = {
						has_idea = threshold_six_percent
						check_variable = { progressive_temp_popularity < 0.06 }
					}
					AND = {
						has_idea = threshold_seven_percent
						check_variable = { progressive_temp_popularity < 0.07 }
					}
					AND = {
						has_idea = threshold_eight_percent
						check_variable = { progressive_temp_popularity < 0.08 }
					}
				}
			}
			add_popularity = {	ideology = progressive popularity = -1 }
			set_variable = { progressive_seats = 0 }
		}
		else = {
			set_variable = { progressive_seats = party_popularity@progressive }
			multiply_variable = { progressive_seats = 100 }
			round_variable = progressive_seats
			set_variable = { progressive_temp_popularity = 0 }
		}
		if = {
			limit = {
				OR = {
					AND = {
						has_idea = threshold_one_percent
						check_variable = { social_democrat_temp_popularity < 0.01 }
					}
					AND = {
						has_idea = threshold_two_percent
						check_variable = { social_democrat_temp_popularity < 0.02 }
					}
					AND = {
						has_idea = threshold_three_percent
						check_variable = { social_democrat_temp_popularity < 0.03 }
					}
					AND = {
						has_idea = threshold_four_percent
						check_variable = { social_democrat_temp_popularity < 0.04 }
					}
					AND = {
						has_idea = threshold_five_percent
						check_variable = { social_democrat_temp_popularity < 0.05 }
					}
					AND = {
						has_idea = threshold_six_percent
						check_variable = { social_democrat_temp_popularity < 0.06 }
					}
					AND = {
						has_idea = threshold_seven_percent
						check_variable = { social_democrat_temp_popularity < 0.07 }
					}
					AND = {
						has_idea = threshold_eight_percent
						check_variable = { social_democrat_temp_popularity < 0.08 }
					}
				}
			}
			add_popularity = {	ideology = social_democrat popularity = -1 }
			set_variable = { social_democrat_seats = 0 }
		}
		else = {
			set_variable = { social_democrat_seats = party_popularity@social_democrat }
			multiply_variable = { social_democrat_seats = 100 }
			round_variable = social_democrat_seats
			set_variable = { social_democrat_temp_popularity = 0 }
		}
		if = {
			limit = {
				OR = {
					AND = {
						has_idea = threshold_one_percent
						check_variable = { social_liberal_temp_popularity < 0.01 }
					}
					AND = {
						has_idea = threshold_two_percent
						check_variable = { social_liberal_temp_popularity < 0.02 }
					}
					AND = {
						has_idea = threshold_three_percent
						check_variable = { social_liberal_temp_popularity < 0.03 }
					}
					AND = {
						has_idea = threshold_four_percent
						check_variable = { social_liberal_temp_popularity < 0.04 }
					}
					AND = {
						has_idea = threshold_five_percent
						check_variable = { social_liberal_temp_popularity < 0.05 }
					}
					AND = {
						has_idea = threshold_six_percent
						check_variable = { social_liberal_temp_popularity < 0.06 }
					}
					AND = {
						has_idea = threshold_seven_percent
						check_variable = { social_liberal_temp_popularity < 0.07 }
					}
					AND = {
						has_idea = threshold_eight_percent
						check_variable = { social_liberal_temp_popularity < 0.08 }
					}
				}
			}
			add_popularity = {	ideology = social_liberal popularity = -1 }
			set_variable = { social_liberal_seats = 0 }
		}
		else = {
			set_variable = { social_liberal_seats = party_popularity@social_liberal }
			multiply_variable = { social_liberal_seats = 100 }
			round_variable = social_liberal_seats
			set_variable = { social_liberal_temp_popularity = 0 }
		}
		if = {
			limit = {
				OR = {
					AND = {
						has_idea = threshold_one_percent
						check_variable = { classical_liberal_temp_popularity < 0.01 }
					}
					AND = {
						has_idea = threshold_two_percent
						check_variable = { classical_liberal_temp_popularity < 0.02 }
					}
					AND = {
						has_idea = threshold_three_percent
						check_variable = { classical_liberal_temp_popularity < 0.03 }
					}
					AND = {
						has_idea = threshold_four_percent
						check_variable = { classical_liberal_temp_popularity < 0.04 }
					}
					AND = {
						has_idea = threshold_five_percent
						check_variable = { classical_liberal_temp_popularity < 0.05 }
					}
					AND = {
						has_idea = threshold_six_percent
						check_variable = { classical_liberal_temp_popularity < 0.06 }
					}
					AND = {
						has_idea = threshold_seven_percent
						check_variable = { classical_liberal_temp_popularity < 0.07 }
					}
					AND = {
						has_idea = threshold_eight_percent
						check_variable = { classical_liberal_temp_popularity < 0.08 }
					}
				}
			}
			add_popularity = {	ideology = classical_liberal popularity = -1 }
			set_variable = { classical_liberal_seats = 0 }
		}
		else = {
			set_variable = { classical_liberal_seats = party_popularity@classical_liberal }
			multiply_variable = { classical_liberal_seats = 100 }
			round_variable = classical_liberal_seats
			set_variable = { classical_liberal_temp_popularity = 0 }
		}
		if = {
			limit = {
				OR = {
					AND = {
						has_idea = threshold_one_percent
						check_variable = { conservative_temp_popularity < 0.01 }
					}
					AND = {
						has_idea = threshold_two_percent
						check_variable = { conservative_temp_popularity < 0.02 }
					}
					AND = {
						has_idea = threshold_three_percent
						check_variable = { conservative_temp_popularity < 0.03 }
					}
					AND = {
						has_idea = threshold_four_percent
						check_variable = { conservative_temp_popularity < 0.04 }
					}
					AND = {
						has_idea = threshold_five_percent
						check_variable = { conservative_temp_popularity < 0.05 }
					}
					AND = {
						has_idea = threshold_six_percent
						check_variable = { conservative_temp_popularity < 0.06 }
					}
					AND = {
						has_idea = threshold_seven_percent
						check_variable = { conservative_temp_popularity < 0.07 }
					}
					AND = {
						has_idea = threshold_eight_percent
						check_variable = { conservative_temp_popularity < 0.08 }
					}
				}
			}
			add_popularity = {	ideology = conservative popularity = -1 }
			set_variable = { conservative_seats = 0 }
		}
		else = {
			set_variable = { conservative_seats = party_popularity@conservative }
			multiply_variable = { conservative_seats = 100 }
			round_variable = conservative_seats
			set_variable = { conservative_temp_popularity = 0 }
		}
		if = {
			limit = {
				OR = {
					AND = {
						has_idea = threshold_one_percent
						check_variable = { national_conservative_temp_popularity < 0.01 }
					}
					AND = {
						has_idea = threshold_two_percent
						check_variable = { national_conservative_temp_popularity < 0.02 }
					}
					AND = {
						has_idea = threshold_three_percent
						check_variable = { national_conservative_temp_popularity < 0.03 }
					}
					AND = {
						has_idea = threshold_four_percent
						check_variable = { national_conservative_temp_popularity < 0.04 }
					}
					AND = {
						has_idea = threshold_five_percent
						check_variable = { national_conservative_temp_popularity < 0.05 }
					}
					AND = {
						has_idea = threshold_six_percent
						check_variable = { national_conservative_temp_popularity < 0.06 }
					}
					AND = {
						has_idea = threshold_seven_percent
						check_variable = { national_conservative_temp_popularity < 0.07 }
					}
					AND = {
						has_idea = threshold_eight_percent
						check_variable = { national_conservative_temp_popularity < 0.08 }
					}
				}
			}
			add_popularity = {	ideology = national_conservative popularity = -1 }
			set_variable = { national_conservative_seats = 0 }
		}
		else = {
			set_variable = { national_conservative_seats = party_popularity@national_conservative }
			multiply_variable = { national_conservative_seats = 100 }
			round_variable = national_conservative_seats
			set_variable = { national_conservative_temp_popularity = 0 }
		}
		if = {
			limit = {
				OR = {
					AND = {
						has_idea = threshold_one_percent
						check_variable = { monarchist_temp_popularity < 0.01 }
					}
					AND = {
						has_idea = threshold_two_percent
						check_variable = { monarchist_temp_popularity < 0.02 }
					}
					AND = {
						has_idea = threshold_three_percent
						check_variable = { monarchist_temp_popularity < 0.03 }
					}
					AND = {
						has_idea = threshold_four_percent
						check_variable = { monarchist_temp_popularity < 0.04 }
					}
					AND = {
						has_idea = threshold_five_percent
						check_variable = { monarchist_temp_popularity < 0.05 }
					}
					AND = {
						has_idea = threshold_six_percent
						check_variable = { monarchist_temp_popularity < 0.06 }
					}
					AND = {
						has_idea = threshold_seven_percent
						check_variable = { monarchist_temp_popularity < 0.07 }
					}
					AND = {
						has_idea = threshold_eight_percent
						check_variable = { monarchist_temp_popularity < 0.08 }
					}
				}
			}
			add_popularity = {	ideology = monarchist popularity = -1 }
			set_variable = { monarchist_seats = 0 }
		}
		else = {
			set_variable = { monarchist_seats = party_popularity@monarchist }
			multiply_variable = { monarchist_seats = 100 }
			round_variable = monarchist_seats
			set_variable = { monarchist_temp_popularity = 0 }
		}
		if = {
			limit = {
				OR = {
					AND = {
						has_idea = threshold_one_percent
						check_variable = { right_wing_populist_temp_popularity < 0.01 }
					}
					AND = {
						has_idea = threshold_two_percent
						check_variable = { right_wing_populist_temp_popularity < 0.02 }
					}
					AND = {
						has_idea = threshold_three_percent
						check_variable = { right_wing_populist_temp_popularity < 0.03 }
					}
					AND = {
						has_idea = threshold_four_percent
						check_variable = { right_wing_populist_temp_popularity < 0.04 }
					}
					AND = {
						has_idea = threshold_five_percent
						check_variable = { right_wing_populist_temp_popularity < 0.05 }
					}
					AND = {
						has_idea = threshold_six_percent
						check_variable = { right_wing_populist_temp_popularity < 0.06 }
					}
					AND = {
						has_idea = threshold_seven_percent
						check_variable = { right_wing_populist_temp_popularity < 0.07 }
					}
					AND = {
						has_idea = threshold_eight_percent
						check_variable = { right_wing_populist_temp_popularity < 0.08 }
					}
				}
			}
			add_popularity = {	ideology = right_wing_populist popularity = -1 }
			set_variable = { right_wing_populist_seats = 0 }
		}
		else = {
			set_variable = { right_wing_populist_seats = party_popularity@right_wing_populist }
			multiply_variable = { right_wing_populist_seats = 100 }
			round_variable = right_wing_populist_seats
			set_variable = { right_wing_populist_temp_popularity = 0 }
		}
		if = {
			limit = {
				OR = {
					AND = {
						has_idea = threshold_one_percent
						check_variable = { fascist_temp_popularity < 0.01 }
					}
					AND = {
						has_idea = threshold_two_percent
						check_variable = { fascist_temp_popularity < 0.02 }
					}
					AND = {
						has_idea = threshold_three_percent
						check_variable = { fascist_temp_popularity < 0.03 }
					}
					AND = {
						has_idea = threshold_four_percent
						check_variable = { fascist_temp_popularity < 0.04 }
					}
					AND = {
						has_idea = threshold_five_percent
						check_variable = { fascist_temp_popularity < 0.05 }
					}
					AND = {
						has_idea = threshold_six_percent
						check_variable = { fascist_temp_popularity < 0.06 }
					}
					AND = {
						has_idea = threshold_seven_percent
						check_variable = { fascist_temp_popularity < 0.07 }
					}
					AND = {
						has_idea = threshold_eight_percent
						check_variable = { fascist_temp_popularity < 0.08 }
					}
				}
			}
			add_popularity = {	ideology = fascist popularity = -1 }
			set_variable = { fascist_seats = 0 }
		}
		else = {
			set_variable = { fascist_seats = party_popularity@fascist }
			multiply_variable = { fascist_seats = 100 }
			round_variable = fascist_seats
			set_variable = { fascist_temp_popularity = 0 }
		}
		if = {
			limit = {
				OR = {
					AND = {
						has_idea = threshold_one_percent
						check_variable = { islamist_temp_popularity < 0.01 }
					}
					AND = {
						has_idea = threshold_two_percent
						check_variable = { islamist_temp_popularity < 0.02 }
					}
					AND = {
						has_idea = threshold_three_percent
						check_variable = { islamist_temp_popularity < 0.03 }
					}
					AND = {
						has_idea = threshold_four_percent
						check_variable = { islamist_temp_popularity < 0.04 }
					}
					AND = {
						has_idea = threshold_five_percent
						check_variable = { islamist_temp_popularity < 0.05 }
					}
					AND = {
						has_idea = threshold_six_percent
						check_variable = { islamist_temp_popularity < 0.06 }
					}
					AND = {
						has_idea = threshold_seven_percent
						check_variable = { islamist_temp_popularity < 0.07 }
					}
					AND = {
						has_idea = threshold_eight_percent
						check_variable = { islamist_temp_popularity < 0.08 }
					}
				}
			}
			add_popularity = {	ideology = islamist popularity = -1 }
			set_variable = { islamist_seats = 0 }
		}
		else = {
			set_variable = { islamist_seats = party_popularity@islamist }
			multiply_variable = { islamist_seats = 100 }
			round_variable = islamist_seats
			set_variable = { islamist_temp_popularity = 0 }
		}
		add_popularity = {	ideology = communist popularity = communist_temp_popularity }
		add_popularity = {	ideology = socialist popularity = socialist_temp_popularity }
		add_popularity = {	ideology = progressive popularity = progressive_temp_popularity }
		add_popularity = {	ideology = social_democrat popularity = social_democrat_temp_popularity }
		add_popularity = {	ideology = social_liberal popularity = social_liberal_temp_popularity }
		add_popularity = {	ideology = classical_liberal popularity = classical_liberal_temp_popularity }
		add_popularity = {	ideology = conservative popularity = conservative_temp_popularity }
		add_popularity = {	ideology = national_conservative popularity = national_conservative_temp_popularity }
		add_popularity = {	ideology = monarchist popularity = monarchist_temp_popularity }
		add_popularity = {	ideology = right_wing_populist popularity = right_wing_populist_temp_popularity }
		add_popularity = {	ideology = fascist popularity = fascist_temp_popularity }
		add_popularity = {	ideology = islamist popularity = islamist_temp_popularity }
		round_parliament_seats = yes
		set_parliament_graphics = yes
		set_neighbor_coalition_values = yes
	}
}

round_parliament_seats = {
	round_variable = communist_seats
	round_variable = socialist_seats
	round_variable = progressive_seats
	round_variable = social_democrat_seats
	round_variable = social_liberal_seats
	round_variable = classical_liberal_seats
	round_variable = conservative_seats
	round_variable = national_conservative_seats
	round_variable = monarchist_seats
	round_variable = right_wing_populist_seats
	round_variable = fascist_seats
	round_variable = islamist_seats
	parliament_math_failsafe = yes
}

one_party_parliament = {
	if = {
		limit = {
			has_government = communist
		}
		set_variable = { communist_seats = 100 }
		set_variable = { socialist_seats = 0 }
		set_variable = { progressive_seats = 0 }
		set_variable = { social_democrat_seats = 0 }
		set_variable = { social_liberal_seats = 0 }
		set_variable = { classical_liberal_seats = 0 }
		set_variable = { conservative_seats = 0 }
		set_variable = { national_conservative_seats = 0 }
		set_variable = { monarchist_seats = 0 }
		set_variable = { right_wing_populist_seats = 0 }
		set_variable = { fascist_seats = 0 }
		set_variable = { islamist_seats = 0 }
	}
	if = {
		limit = {
			has_government = socialist
		}
		set_variable = { communist_seats = 0 }
		set_variable = { socialist_seats = 100 }
		set_variable = { progressive_seats = 0 }
		set_variable = { social_democrat_seats = 0 }
		set_variable = { social_liberal_seats = 0 }
		set_variable = { classical_liberal_seats = 0 }
		set_variable = { conservative_seats = 0 }
		set_variable = { national_conservative_seats = 0 }
		set_variable = { monarchist_seats = 0 }
		set_variable = { right_wing_populist_seats = 0 }
		set_variable = { fascist_seats = 0 }
		set_variable = { islamist_seats = 0 }
	}
	if = {
		limit = {
			has_government = progressive
		}
		set_variable = { communist_seats = 0 }
		set_variable = { socialist_seats = 0 }
		set_variable = { progressive_seats = 100 }
		set_variable = { social_democrat_seats = 0 }
		set_variable = { social_liberal_seats = 0 }
		set_variable = { classical_liberal_seats = 0 }
		set_variable = { conservative_seats = 0 }
		set_variable = { national_conservative_seats = 0 }
		set_variable = { monarchist_seats = 0 }
		set_variable = { right_wing_populist_seats = 0 }
		set_variable = { fascist_seats = 0 }
		set_variable = { islamist_seats = 0 }
	}
	if = {
		limit = {
			has_government = social_democrat
		}
		set_variable = { communist_seats = 0 }
		set_variable = { socialist_seats = 0 }
		set_variable = { progressive_seats = 0 }
		set_variable = { social_democrat_seats = 100 }
		set_variable = { social_liberal_seats = 0 }
		set_variable = { classical_liberal_seats = 0 }
		set_variable = { conservative_seats = 0 }
		set_variable = { national_conservative_seats = 0 }
		set_variable = { monarchist_seats = 0 }
		set_variable = { right_wing_populist_seats = 0 }
		set_variable = { fascist_seats = 0 }
		set_variable = { islamist_seats = 0 }
	}
	if = {
		limit = {
			has_government = social_liberal
		}
		set_variable = { communist_seats = 0 }
		set_variable = { socialist_seats = 0 }
		set_variable = { progressive_seats = 0 }
		set_variable = { social_democrat_seats = 0 }
		set_variable = { social_liberal_seats = 100 }
		set_variable = { classical_liberal_seats = 0 }
		set_variable = { conservative_seats = 0 }
		set_variable = { national_conservative_seats = 0 }
		set_variable = { monarchist_seats = 0 }
		set_variable = { right_wing_populist_seats = 0 }
		set_variable = { fascist_seats = 0 }
		set_variable = { islamist_seats = 0 }
	}
	if = {
		limit = {
			has_government = classical_liberal
		}
		set_variable = { communist_seats = 0 }
		set_variable = { socialist_seats = 0 }
		set_variable = { progressive_seats = 0 }
		set_variable = { social_democrat_seats = 0 }
		set_variable = { social_liberal_seats = 0 }
		set_variable = { classical_liberal_seats = 100 }
		set_variable = { conservative_seats = 0 }
		set_variable = { national_conservative_seats = 0 }
		set_variable = { monarchist_seats = 0 }
		set_variable = { right_wing_populist_seats = 0 }
		set_variable = { fascist_seats = 0 }
		set_variable = { islamist_seats = 0 }
	}
	if = {
		limit = {
			has_government = conservative
		}
		set_variable = { communist_seats = 0 }
		set_variable = { socialist_seats = 0 }
		set_variable = { progressive_seats = 0 }
		set_variable = { social_democrat_seats = 0 }
		set_variable = { social_liberal_seats = 0 }
		set_variable = { classical_liberal_seats = 0 }
		set_variable = { conservative_seats = 100 }
		set_variable = { national_conservative_seats = 0 }
		set_variable = { monarchist_seats = 0 }
		set_variable = { right_wing_populist_seats = 0 }
		set_variable = { fascist_seats = 0 }
		set_variable = { islamist_seats = 0 }
	}
	if = {
		limit = {
			has_government = national_conservative
		}
		set_variable = { communist_seats = 0 }
		set_variable = { socialist_seats = 0 }
		set_variable = { progressive_seats = 0 }
		set_variable = { social_democrat_seats = 0 }
		set_variable = { social_liberal_seats = 0 }
		set_variable = { classical_liberal_seats = 0 }
		set_variable = { conservative_seats = 0 }
		set_variable = { national_conservative_seats = 100 }
		set_variable = { monarchist_seats = 0 }
		set_variable = { right_wing_populist_seats = 0 }
		set_variable = { fascist_seats = 0 }
		set_variable = { islamist_seats = 0 }
	}
	if = {
		limit = {
			has_government = monarchist
		}
		set_variable = { communist_seats = 0 }
		set_variable = { socialist_seats = 0 }
		set_variable = { progressive_seats = 0 }
		set_variable = { social_democrat_seats = 0 }
		set_variable = { social_liberal_seats = 0 }
		set_variable = { classical_liberal_seats = 0 }
		set_variable = { conservative_seats = 0 }
		set_variable = { national_conservative_seats = 0 }
		set_variable = { monarchist_seats = 100 }
		set_variable = { right_wing_populist_seats = 0 }
		set_variable = { fascist_seats = 0 }
		set_variable = { islamist_seats = 0 }
	}
	if = {
		limit = {
			has_government = right_wing_populist
		}
		set_variable = { communist_seats = 0 }
		set_variable = { socialist_seats = 0 }
		set_variable = { progressive_seats = 0 }
		set_variable = { social_democrat_seats = 0 }
		set_variable = { social_liberal_seats = 0 }
		set_variable = { classical_liberal_seats = 0 }
		set_variable = { conservative_seats = 0 }
		set_variable = { national_conservative_seats = 0 }
		set_variable = { monarchist_seats = 0 }
		set_variable = { right_wing_populist_seats = 100 }
		set_variable = { fascist_seats = 0 }
		set_variable = { islamist_seats = 0 }
	}
	if = {
		limit = {
			has_government = fascist
		}
		set_variable = { communist_seats = 0 }
		set_variable = { socialist_seats = 0 }
		set_variable = { progressive_seats = 0 }
		set_variable = { social_democrat_seats = 0 }
		set_variable = { social_liberal_seats = 0 }
		set_variable = { classical_liberal_seats = 0 }
		set_variable = { conservative_seats = 0 }
		set_variable = { national_conservative_seats = 0 }
		set_variable = { monarchist_seats = 0 }
		set_variable = { right_wing_populist_seats = 0 }
		set_variable = { fascist_seats = 100 }
		set_variable = { islamist_seats = 0 }
	}
	if = {
		limit = {
			has_government = islamist
		}
		set_variable = { communist_seats = 0 }
		set_variable = { socialist_seats = 0 }
		set_variable = { progressive_seats = 0 }
		set_variable = { social_democrat_seats = 0 }
		set_variable = { social_liberal_seats = 0 }
		set_variable = { classical_liberal_seats = 0 }
		set_variable = { conservative_seats = 0 }
		set_variable = { national_conservative_seats = 0 }
		set_variable = { monarchist_seats = 0 }
		set_variable = { right_wing_populist_seats = 0 }
		set_variable = { fascist_seats = 0 }
		set_variable = { islamist_seats = 100 }
	}
	set_parliament_graphics = yes
}

quickset_coalition = {
	break_coalition = yes
	if = {
		limit = {
			has_government = communist
		}
		set_country_flag = coalition_communist
        set_variable = { ROOT.Coalition = communist_seats }
	}
	if = {
		limit = {
			has_government = socialist
		}
		set_country_flag = coalition_socialist
        set_variable = { ROOT.Coalition = socialist_seats }
	}
	if = {
		limit = {
			has_government = progressive
		}
		set_country_flag = coalition_progressive
        set_variable = { ROOT.Coalition = progressive_seats }
	}
	if = {
		limit = {
			has_government = social_democrat
		}
		set_country_flag = coalition_social_democrat
        set_variable = { ROOT.Coalition = social_democrat_seats }
	}
	if = {
		limit = {
			has_government = social_liberal
		}
		set_country_flag = coalition_social_liberal
        set_variable = { ROOT.Coalition = social_liberal_seats }
	}
	if = {
		limit = {
			has_government = classical_liberal
		}
		set_country_flag = coalition_classical_liberal
        set_variable = { ROOT.Coalition = classical_liberal_seats }
	}
	if = {
		limit = {
			has_government = conservative
		}
		set_country_flag = coalition_conservative
        set_variable = { ROOT.Coalition = conservative_seats }
	}
	if = {
		limit = {
			has_government = national_conservative
		}
		set_country_flag = coalition_national_conservative
        set_variable = { ROOT.Coalition = national_conservative_seats }
	}
	if = {
		limit = {
			has_government = monarchist
		}
		set_country_flag = coalition_monarchist
        set_variable = { ROOT.Coalition = monarchist_seats }
	}
	if = {
		limit = {
			has_government = right_wing_populist
		}
		set_country_flag = coalition_right_wing_populist
        set_variable = { ROOT.Coalition = right_wing_populist_seats }
	}
	if = {
		limit = {
			has_government = fascist
		}
		set_country_flag = coalition_fascist
        set_variable = { ROOT.Coalition = fascist_seats }
	}
	if = {
		limit = {
			has_government = islamist
		}
		set_country_flag = coalition_islamist
        set_variable = { ROOT.Coalition = islamist_seats }
	}
	set_parliament_graphics = yes
}

quickset_coalition_flags_only = {
	if = {
		limit = {
			has_government = communist
		}
		set_country_flag = coalition_communist
	}
	if = {
		limit = {
			has_government = socialist
		}
		set_country_flag = coalition_socialist
	}
	if = {
		limit = {
			has_government = progressive
		}
		set_country_flag = coalition_progressive
	}
	if = {
		limit = {
			has_government = social_democrat
		}
		set_country_flag = coalition_social_democrat
	}
	if = {
		limit = {
			has_government = social_liberal
		}
		set_country_flag = coalition_social_liberal
	}
	if = {
		limit = {
			has_government = classical_liberal
		}
		set_country_flag = coalition_classical_liberal
	}
	if = {
		limit = {
			has_government = conservative
		}
		set_country_flag = coalition_conservative
	}
	if = {
		limit = {
			has_government = national_conservative
		}
		set_country_flag = coalition_national_conservative
	}
	if = {
		limit = {
			has_government = monarchist
		}
		set_country_flag = coalition_monarchist
	}
	if = {
		limit = {
			has_government = right_wing_populist
		}
		set_country_flag = coalition_right_wing_populist
	}
	if = {
		limit = {
			has_government = fascist
		}
		set_country_flag = coalition_fascist
	}
	if = {
		limit = {
			has_government = islamist
		}
		set_country_flag = coalition_islamist
	}
}

set_parliament_graphics = {
	set_coalition_seats = yes

	cleanup_seats_parliament = yes
	set_new_parliament_seats = yes
	set_variable = { communist_seats_parliament = communist_seats }
	set_variable = { socialist_seats_parliament = socialist_seats }
	set_variable = { social_democrat_seats_parliament = social_democrat_seats }
	set_variable = { progressive_seats_parliament = progressive_seats }
	set_variable = { social_liberal_seats_parliament = social_liberal_seats }
	set_variable = { classical_liberal_seats_parliament = classical_liberal_seats }
	set_variable = { conservative_seats_parliament = conservative_seats }
	set_variable = { islamist_seats_parliament = islamist_seats }
	set_variable = { monarchist_seats_parliament = monarchist_seats }
	set_variable = { national_conservative_seats_parliament = national_conservative_seats }
	set_variable = { right_wing_populist_seats_parliament = right_wing_populist_seats }
	set_variable = { fascist_seats_parliament = fascist_seats }

	round_variable = communist_seats_parliament
	round_variable = socialist_seats_parliament
	round_variable = social_democrat_seats_parliament
	round_variable = progressive_seats_parliament
	round_variable = social_liberal_seats_parliament
	round_variable = classical_liberal_seats_parliament
	round_variable = conservative_seats_parliament
	round_variable = islamist_seats_parliament
	round_variable = monarchist_seats_parliament
	round_variable = national_conservative_seats_parliament
	round_variable = right_wing_populist_seats_parliament
	round_variable = fascist_seats_parliament

	clear_array = ideology_seats_array
	clear_array = parliament_array
	clear_array = parliament_popularity_array
	add_to_array = { ideology_seats_array = 0 } # Placeholder, I need the frames to be 1-12 and not 0-11
	add_to_array = { ideology_seats_array = communist_seats_parliament }
	add_to_array = { ideology_seats_array = socialist_seats_parliament }
	add_to_array = { ideology_seats_array = social_democrat_seats_parliament }
	add_to_array = { ideology_seats_array = progressive_seats_parliament }
	add_to_array = { ideology_seats_array = social_liberal_seats_parliament }
	add_to_array = { ideology_seats_array = classical_liberal_seats_parliament }
	add_to_array = { ideology_seats_array = conservative_seats_parliament }
	add_to_array = { ideology_seats_array = islamist_seats_parliament }
	add_to_array = { ideology_seats_array = monarchist_seats_parliament }
	add_to_array = { ideology_seats_array = national_conservative_seats_parliament }
	add_to_array = { ideology_seats_array = right_wing_populist_seats_parliament }
	add_to_array = { ideology_seats_array = fascist_seats_parliament }

	for_each_loop = {
		array = ideology_seats_array
		if = {
			limit = {
				check_variable = { v > 99 }
				check_variable = { i < 2 }
			}
			add_to_array = { parliament_array = 98^i }
		}
		if = {
			limit = {
				check_variable = { v > 99 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 98 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 97 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 96 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 95 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 94 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 93 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 92 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 91 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 90 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 89 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 88 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 87 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 86 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 85 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 84 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 83 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 82 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 81 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 80 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 79 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 78 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 77 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 76 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 75 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 74 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 73 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 72 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 71 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 70 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 69 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 68 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 67 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 66 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 65 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 64 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 63 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 62 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 61 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 60 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 59 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 58 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 57 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 49 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 56 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 55 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 54 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 53 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 52 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 51 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 50 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 49 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 48 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 47 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 46 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 45 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 44 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 43 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 42 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 41 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 40 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 39 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 38 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 37 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 36 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 35 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 34 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 33 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 32 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 31 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 30 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 29 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 28 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 27 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 26 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 25 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 24 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 23 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 22 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 21 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 20 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 19 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 18 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 17 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 16 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 15 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 14 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 13 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 12 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 11 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 10 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 9 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 8 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 7 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 6 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 5 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 4 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 3 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 2 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 1 }
			}
			add_to_array = { parliament_array = i }
		}
		if = {
			limit = {
				check_variable = { v > 0 }
			}
			add_to_array = { parliament_array = i }
		}
	}
	if = {
		limit = {
			check_variable = { parliament_array^num > 101 }
		}
		resize_array = {
			parliament_array = 101
		}
	}
	set_parliament_popularity_array = yes
	create_pie_chart = yes

	set_variable = {
		ROOT.GroupGFX = ROOT.Coalition
	}
	divide_variable = { ROOT.GroupGFX = 100 }
	multiply_variable = { ROOT.GroupGFX = 230 }

	set_parliament_speaker_plurality = yes
}

set_coalition_to_array = {
	if = {
		limit = {
			has_country_flag = coalition_islamist
		}
		add_to_array = { member_parties_array = 1 }
	}
	if = {
		limit = {
			has_country_flag = coalition_fascist
		}
		add_to_array = { member_parties_array = 2 }
	}
	if = {
		limit = {
			has_country_flag = coalition_right_wing_populist
		}
		add_to_array = { member_parties_array = 3 }
	}
	if = {
		limit = {
			has_country_flag = coalition_monarchist
		}
		add_to_array = { member_parties_array = 4 }
	}
	if = {
		limit = {
			has_country_flag = coalition_national_conservative
		}
		add_to_array = { member_parties_array = 5 }
	}
	if = {
		limit = {
			has_country_flag = coalition_conservative
		}
		add_to_array = { member_parties_array = 6 }
	}
	if = {
		limit = {
			has_country_flag = coalition_classical_liberal
		}
		add_to_array = { member_parties_array = 7 }
	}
	if = {
		limit = {
			has_country_flag = coalition_social_liberal
		}
		add_to_array = { member_parties_array = 8 }
	}
	if = {
		limit = {
			has_country_flag = coalition_social_democrat
		}
		add_to_array = { member_parties_array = 9 }
	}
	if = {
		limit = {
			has_country_flag = coalition_progressive
		}
		add_to_array = { member_parties_array = 10 }
	}
	if = {
		limit = {
			has_country_flag = coalition_socialist
		}
		add_to_array = { member_parties_array = 11 }
	}
	if = {
		limit = {
			has_country_flag = coalition_communist
		}
		add_to_array = { member_parties_array = 12 }
	}
}

# Scripted GUI Pie Chart by Yard1

# this creates a pie chart of popularities - can be easily adapted to show anything that adds up to 100%
create_pie_chart = {
	clear_array = pie_chart
	resize_array = {
		array = pie_chart
		value = 1 # 1 is value for neutrality frame, so we don't have to make a loop for it
		size = 100 # 100 pieces, each percent is one piece
	}
	set_temp_variable = { communist_pop = communist_seats_parliament }
	round_temp_variable = communist_pop

	set_temp_variable = { socialist_pop = socialist_seats_parliament }
	round_temp_variable = socialist_pop 
	set_variable = { ROOT.last_idx = communist_pop }
	add_to_temp_variable = { socialist_pop = ROOT.last_idx }
	for_loop_effect = {
		start = ROOT.last_idx
		end = socialist_pop
		set_variable = { pie_chart^v = 2 }
		add_to_variable = { ROOT.last_idx = 1 }
	}

	set_temp_variable = { social_democrat_pop = social_democrat_seats_parliament }
	round_temp_variable = social_democrat_pop 
	add_to_temp_variable = { social_democrat_pop = ROOT.last_idx }
	for_loop_effect = {
		start = ROOT.last_idx
		end = social_democrat_pop
		set_variable = { pie_chart^v = 3 }
		add_to_variable = { ROOT.last_idx = 1 }
	}

	set_temp_variable = { progressive_pop = progressive_seats_parliament }
	round_temp_variable = progressive_pop 
	add_to_temp_variable = { progressive_pop = ROOT.last_idx }
	for_loop_effect = {
		start = ROOT.last_idx
		end = progressive_pop
		set_variable = { pie_chart^v = 4 }
		add_to_variable = { ROOT.last_idx = 1 }
	}

	set_temp_variable = { social_liberal_pop = social_liberal_seats_parliament }
	round_temp_variable = social_liberal_pop 
	add_to_temp_variable = { social_liberal_pop = ROOT.last_idx }
	for_loop_effect = {
		start = ROOT.last_idx
		end = social_liberal_pop
		set_variable = { pie_chart^v = 5 }
		add_to_variable = { ROOT.last_idx = 1 }
	}

	set_temp_variable = { classical_liberal_pop = classical_liberal_seats_parliament }
	round_temp_variable = classical_liberal_pop 
	add_to_temp_variable = { classical_liberal_pop = ROOT.last_idx }
	for_loop_effect = {
		start = ROOT.last_idx
		end = classical_liberal_pop
		set_variable = { pie_chart^v = 6 }
		add_to_variable = { ROOT.last_idx = 1 }
	}

	set_temp_variable = { conservative_pop = conservative_seats_parliament }
	round_temp_variable = conservative_pop 
	add_to_temp_variable = { conservative_pop = ROOT.last_idx }
	for_loop_effect = {
		start = ROOT.last_idx
		end = conservative_pop
		set_variable = { pie_chart^v = 7 }
		add_to_variable = { ROOT.last_idx = 1 }
	}

	set_temp_variable = { islamist_pop = islamist_seats_parliament }
	round_temp_variable = islamist_pop 
	add_to_temp_variable = { islamist_pop = ROOT.last_idx }
	for_loop_effect = {
		start = ROOT.last_idx
		end = islamist_pop
		set_variable = { pie_chart^v = 8 }
		add_to_variable = { ROOT.last_idx = 1 }
	}

	set_temp_variable = { monarchist_pop = monarchist_seats_parliament }
	round_temp_variable = monarchist_pop 
	add_to_temp_variable = { monarchist_pop = ROOT.last_idx }
	for_loop_effect = {
		start = ROOT.last_idx
		end = monarchist_pop
		set_variable = { pie_chart^v = 9 }
		add_to_variable = { ROOT.last_idx = 1 }
	}

	set_temp_variable = { national_conservative_pop = national_conservative_seats_parliament }
	round_temp_variable = national_conservative_pop 
	add_to_temp_variable = { national_conservative_pop = ROOT.last_idx }
	for_loop_effect = {
		start = ROOT.last_idx
		end = national_conservative_pop
		set_variable = { pie_chart^v = 10 }
		add_to_variable = { ROOT.last_idx = 1 }
	}

	set_temp_variable = { right_wing_populist_pop = right_wing_populist_seats_parliament }
	round_temp_variable = right_wing_populist_pop 
	add_to_temp_variable = { right_wing_populist_pop = ROOT.last_idx }
	for_loop_effect = {
		start = ROOT.last_idx
		end = right_wing_populist_pop
		set_variable = { pie_chart^v = 11 }
		add_to_variable = { ROOT.last_idx = 1 }
	}

	set_temp_variable = { fascist_pop = fascist_seats_parliament }
	round_temp_variable = fascist_pop 
	add_to_temp_variable = { fascist_pop = ROOT.last_idx }
	for_loop_effect = {
		start = ROOT.last_idx
		end = fascist_pop
		set_variable = { pie_chart^v = 12 }
	}

	clear_variable = ROOT.last_idx
	add_to_variable = { pie_chart_dirty = 1 }
}

# New Parliament System for 100 seats
set_new_parliament_seats = {
	clear_array = x_pos_array
	clear_array = y_pos_array
	add_to_array = { x_pos_array = 0 }
	add_to_array = { y_pos_array = 571 }
	add_to_array = { x_pos_array = 33 }
	add_to_array = { y_pos_array = 571 }
	add_to_array = { x_pos_array = 66 }
	add_to_array = { y_pos_array = 571 }
	add_to_array = { x_pos_array = 99 }
	add_to_array = { y_pos_array = 571 }
	add_to_array = { x_pos_array = 133 }
	add_to_array = { y_pos_array = 571 }
	add_to_array = { x_pos_array = 166 }
	add_to_array = { y_pos_array = 571 }
	add_to_array = { x_pos_array = 4 }
	add_to_array = { y_pos_array = 528 }
	add_to_array = { x_pos_array = 38 }
	add_to_array = { y_pos_array = 527 }
	add_to_array = { x_pos_array = 72 }
	add_to_array = { y_pos_array = 528 }
	add_to_array = { x_pos_array = 106 }
	add_to_array = { y_pos_array = 527 }
	add_to_array = { x_pos_array = 140 }
	add_to_array = { y_pos_array = 529 }
	add_to_array = { x_pos_array = 14 }
	add_to_array = { y_pos_array = 487 }
	add_to_array = { x_pos_array = 50 }
	add_to_array = { y_pos_array = 486 }
	add_to_array = { x_pos_array = 175 }
	add_to_array = { y_pos_array = 531 }
	add_to_array = { x_pos_array = 85 }
	add_to_array = { y_pos_array = 488 }
	add_to_array = { x_pos_array = 30 }
	add_to_array = { y_pos_array = 448 }
	add_to_array = { x_pos_array = 123 }
	add_to_array = { y_pos_array = 486 }
	add_to_array = { x_pos_array = 69 }
	add_to_array = { y_pos_array = 446 }
	add_to_array = { x_pos_array = 159 }
	add_to_array = { y_pos_array = 490 }
	add_to_array = { x_pos_array = 105 }
	add_to_array = { y_pos_array = 451 }
	add_to_array = { x_pos_array = 51 }
	add_to_array = { y_pos_array = 412 }
	add_to_array = { x_pos_array = 195 }
	add_to_array = { y_pos_array = 495 }
	add_to_array = { x_pos_array = 93 }
	add_to_array = { y_pos_array = 411 }
	add_to_array = { x_pos_array = 147 }
	add_to_array = { y_pos_array = 449 }
	add_to_array = { x_pos_array = 77 }
	add_to_array = { y_pos_array = 378 }
	add_to_array = { x_pos_array = 131 }
	add_to_array = { y_pos_array = 417 }
	add_to_array = { x_pos_array = 186 }
	add_to_array = { y_pos_array = 457 }
	add_to_array = { x_pos_array = 123 }
	add_to_array = { y_pos_array = 379 }
	add_to_array = { x_pos_array = 108 }
	add_to_array = { y_pos_array = 349 }
	add_to_array = { x_pos_array = 179 }
	add_to_array = { y_pos_array = 419 }
	add_to_array = { x_pos_array = 163 }
	add_to_array = { y_pos_array = 390 }
	add_to_array = { x_pos_array = 225 }
	add_to_array = { y_pos_array = 467 }
	add_to_array = { x_pos_array = 158 }
	add_to_array = { y_pos_array = 353 }
	add_to_array = { x_pos_array = 142 }
	add_to_array = { y_pos_array = 324 }
	add_to_array = { x_pos_array = 220 }
	add_to_array = { y_pos_array = 432 }
	add_to_array = { x_pos_array = 200 }
	add_to_array = { y_pos_array = 368 }
	add_to_array = { x_pos_array = 217 }
	add_to_array = { y_pos_array = 396 }
	add_to_array = { x_pos_array = 179 }
	add_to_array = { y_pos_array = 304 }
	add_to_array = { x_pos_array = 197 }
	add_to_array = { y_pos_array = 333 }
	add_to_array = { x_pos_array = 262 }
	add_to_array = { y_pos_array = 450 }
	add_to_array = { x_pos_array = 219 }
	add_to_array = { y_pos_array = 290 }
	add_to_array = { x_pos_array = 239 }
	add_to_array = { y_pos_array = 353 }
	add_to_array = { x_pos_array = 260 }
	add_to_array = { y_pos_array = 416 }
	add_to_array = { x_pos_array = 238 }
	add_to_array = { y_pos_array = 319 }
	add_to_array = { x_pos_array = 259 }
	add_to_array = { y_pos_array = 382 }
	add_to_array = { x_pos_array = 260 }
	add_to_array = { y_pos_array = 281 }
	add_to_array = { x_pos_array = 281 }
	add_to_array = { y_pos_array = 345 }
	add_to_array = { x_pos_array = 281 }
	add_to_array = { y_pos_array = 312 }
	add_to_array = { x_pos_array = 302 }
	add_to_array = { y_pos_array = 444 }
	add_to_array = { x_pos_array = 302 }
	add_to_array = { y_pos_array = 377 }
	add_to_array = { x_pos_array = 302 }
	add_to_array = { y_pos_array = 278 }
	add_to_array = { x_pos_array = 302 }
	add_to_array = { y_pos_array = 411 }
	add_to_array = { x_pos_array = 324 }
	add_to_array = { y_pos_array = 312 }
	add_to_array = { x_pos_array = 324 }
	add_to_array = { y_pos_array = 345 }
	add_to_array = { x_pos_array = 344 }
	add_to_array = { y_pos_array = 281 }
	add_to_array = { x_pos_array = 346 }
	add_to_array = { y_pos_array = 382 }
	add_to_array = { x_pos_array = 367 }
	add_to_array = { y_pos_array = 319 }
	add_to_array = { x_pos_array = 345 }
	add_to_array = { y_pos_array = 416 }
	add_to_array = { x_pos_array = 365 }
	add_to_array = { y_pos_array = 353 }
	add_to_array = { x_pos_array = 386 }
	add_to_array = { y_pos_array = 290 }
	add_to_array = { x_pos_array = 343 }
	add_to_array = { y_pos_array = 450 }
	add_to_array = { x_pos_array = 408 }
	add_to_array = { y_pos_array = 333 }
	add_to_array = { x_pos_array = 426 }
	add_to_array = { y_pos_array = 304 }
	add_to_array = { x_pos_array = 388 }
	add_to_array = { y_pos_array = 396 }
	add_to_array = { x_pos_array = 405 }
	add_to_array = { y_pos_array = 368 }
	add_to_array = { x_pos_array = 384 }
	add_to_array = { y_pos_array = 432 }
	add_to_array = { x_pos_array = 463 }
	add_to_array = { y_pos_array = 324 }
	add_to_array = { x_pos_array = 447 }
	add_to_array = { y_pos_array = 353 }
	add_to_array = { x_pos_array = 380 }
	add_to_array = { y_pos_array = 467 }
	add_to_array = { x_pos_array = 441 }
	add_to_array = { y_pos_array = 390 }
	add_to_array = { x_pos_array = 426 }
	add_to_array = { y_pos_array = 419 }
	add_to_array = { x_pos_array = 497 }
	add_to_array = { y_pos_array = 349 }
	add_to_array = { x_pos_array = 481 }
	add_to_array = { y_pos_array = 379 }
	add_to_array = { x_pos_array = 419 }
	add_to_array = { y_pos_array = 457 }
	add_to_array = { x_pos_array = 473 }
	add_to_array = { y_pos_array = 417 }
	add_to_array = { x_pos_array = 527 }
	add_to_array = { y_pos_array = 378 }
	add_to_array = { x_pos_array = 458 }
	add_to_array = { y_pos_array = 449 }
	add_to_array = { x_pos_array = 511 }
	add_to_array = { y_pos_array = 411 }
	add_to_array = { x_pos_array = 409 }
	add_to_array = { y_pos_array = 495 }
	add_to_array = { x_pos_array = 553 }
	add_to_array = { y_pos_array = 412 }
	add_to_array = { x_pos_array = 500 }
	add_to_array = { y_pos_array = 451 }
	add_to_array = { x_pos_array = 446 }
	add_to_array = { y_pos_array = 490 }
	add_to_array = { x_pos_array = 536 }
	add_to_array = { y_pos_array = 446 }
	add_to_array = { x_pos_array = 482 }
	add_to_array = { y_pos_array = 486 }
	add_to_array = { x_pos_array = 574 }
	add_to_array = { y_pos_array = 448 }
	add_to_array = { x_pos_array = 520 }
	add_to_array = { y_pos_array = 488 }
	add_to_array = { x_pos_array = 430 }
	add_to_array = { y_pos_array = 531 }
	add_to_array = { x_pos_array = 554 }
	add_to_array = { y_pos_array = 486 }
	add_to_array = { x_pos_array = 590 }
	add_to_array = { y_pos_array = 487 }
	add_to_array = { x_pos_array = 464 }
	add_to_array = { y_pos_array = 529 }
	add_to_array = { x_pos_array = 498 }
	add_to_array = { y_pos_array = 527 }
	add_to_array = { x_pos_array = 533 }
	add_to_array = { y_pos_array = 528 }
	add_to_array = { x_pos_array = 566 }
	add_to_array = { y_pos_array = 527 }
	add_to_array = { x_pos_array = 600 }
	add_to_array = { y_pos_array = 528 }
	add_to_array = { x_pos_array = 439 }
	add_to_array = { y_pos_array = 571 }
	add_to_array = { x_pos_array = 472 }
	add_to_array = { y_pos_array = 571 }
	add_to_array = { x_pos_array = 505 }
	add_to_array = { y_pos_array = 571 }
	add_to_array = { x_pos_array = 538 }
	add_to_array = { y_pos_array = 571 }
	add_to_array = { x_pos_array = 572 }
	add_to_array = { y_pos_array = 571 }
	add_to_array = { x_pos_array = 605 }
	add_to_array = { y_pos_array = 571 }
}

set_parliament_popularity_array = {
	clear_array = parliament_popularity_array
	if = {
		limit = {
			is_in_array = {	parliament_array = 1 }
		}
		add_to_array = { parliament_popularity_array = 1 }
	}
	if = {
		limit = {
			is_in_array = {	parliament_array = 2 }
		}
		add_to_array = { parliament_popularity_array = 2 }
	}
	if = {
		limit = {
			is_in_array = {	parliament_array = 3 }
		}
		add_to_array = { parliament_popularity_array = 3 }
	}
	if = {
		limit = {
			is_in_array = {	parliament_array = 4 }
		}
		add_to_array = { parliament_popularity_array = 4 }
	}
	if = {
		limit = {
			is_in_array = {	parliament_array = 5 }
		}
		add_to_array = { parliament_popularity_array = 5 }
	}
	if = {
		limit = {
			is_in_array = {	parliament_array = 6 }
		}
		add_to_array = { parliament_popularity_array = 6 }
	}
	if = {
		limit = {
			is_in_array = {	parliament_array = 7 }
		}
		add_to_array = { parliament_popularity_array = 7 }
	}
	if = {
		limit = {
			is_in_array = {	parliament_array = 8 }
		}
		add_to_array = { parliament_popularity_array = 8 }
	}
	if = {
		limit = {
			is_in_array = {	parliament_array = 9 }
		}
		add_to_array = { parliament_popularity_array = 9 }
	}
	if = {
		limit = {
			is_in_array = {	parliament_array = 10 }
		}
		add_to_array = { parliament_popularity_array = 10 }
	}
	if = {
		limit = {
			is_in_array = {	parliament_array = 11 }
		}
		add_to_array = { parliament_popularity_array = 11 }
	}
	if = {
		limit = {
			is_in_array = {	parliament_array = 12 }
		}
		add_to_array = { parliament_popularity_array = 12 }
	}
	#for_each_loop = {
	#	array = parliament_popularity_array
	#	log = "[?parliament_popularity_array^i]"
	#}
}

set_parliament_speaker_plurality = {
	if = {
		limit = {
			communist_plurality_seats = yes
		}
		set_variable = { plurality_var = 1 }
	}
	if = {
		limit = {
			socialist_plurality_seats = yes
		}
		set_variable = { plurality_var = 2 }
	}
	if = {
		limit = {
			social_democrat_plurality_seats = yes
		}
		set_variable = { plurality_var = 3 }
	}
	if = {
		limit = {
			progressive_plurality_seats = yes
		}
		set_variable = { plurality_var = 4 }
	}
	if = {
		limit = {
			social_liberal_plurality_seats = yes
		}
		set_variable = { plurality_var = 5 }
	}
	if = {
		limit = {
			classical_liberal_plurality_seats = yes
		}
		set_variable = { plurality_var = 6 }
	}
	if = {
		limit = {
			conservative_plurality_seats = yes
		}
		set_variable = { plurality_var = 7 }
	}
	if = {
		limit = {
			islamist_plurality_seats = yes
		}
		set_variable = { plurality_var = 8 }
	}
	if = {
		limit = {
			monarchist_plurality_seats = yes
		}
		set_variable = { plurality_var = 9 }
	}
	if = {
		limit = {
			national_conservative_plurality_seats = yes
		}
		set_variable = { plurality_var = 10 }
	}
	if = {
		limit = {
			right_wing_populist_plurality_seats = yes
		}
		set_variable = { plurality_var = 11 }
	}
	if = {
		limit = {
			fascist_plurality_seats = yes
		}
		set_variable = { plurality_var = 12 }
	}
}

set_pro_european_commission = {
	if = {
		limit = {
			check_variable = {
				var = EUU.EPP_seats
				value = EUU.ALDE_seats
				compare = greater_than_or_equals
			}
			check_variable = {
				var = EUU.EPP_seats
				value = EUU.SD_seats
				compare = greater_than_or_equals
			}
			check_variable = {
				var = EUU.EPP_seats
				value = EUU.GREENS_EFA_seats
				compare = greater_than_or_equals
			}
		}
		EUU = {
			set_politics = {	
				ruling_party = conservative
				elections_allowed = yes
			}
		}
	}
	if = {
		limit = {
			check_variable = {
				var = EUU.ALDE_seats
				value = EUU.EPP_seats
				compare = greater_than_or_equals
			}
			check_variable = {
				var = EUU.ALDE_seats
				value = EUU.SD_seats
				compare = greater_than_or_equals
			}
			check_variable = {
				var = EUU.ALDE_seats
				value = EUU.GREENS_EFA_seats
				compare = greater_than_or_equals
			}
		}
		EUU = {
			random_list = {
				50 = {
					set_politics = {	
						ruling_party = social_liberal
						elections_allowed = yes
					}
				}
				50 = {
					set_politics = {	
						ruling_party = classical_liberal
						elections_allowed = yes
					}
				}
			}
		}
	}
	if = {
		limit = {
			check_variable = {
				var = EUU.SD_seats
				value = EUU.ALDE_seats
				compare = greater_than_or_equals
			}
			check_variable = {
				var = EUU.SD_seats
				value = EUU.EPP_seats
				compare = greater_than_or_equals
			}
			check_variable = {
				var = EUU.SD_seats
				value = EUU.GREENS_EFA_seats
				compare = greater_than_or_equals
			}
		}
		EUU = {
			set_politics = {	
				ruling_party = social_democrat
				elections_allowed = yes
			}
		}
	}
	if = {
		limit = {
			check_variable = {
				var = EUU.GREENS_EFA_seats
				value = EUU.EPP_seats
				compare = greater_than_or_equals
			}
			check_variable = {
				var = EUU.GREENS_EFA_seats
				value = EUU.SD_seats
				compare = greater_than_or_equals
			}
			check_variable = {
				var = EUU.GREENS_EFA_seats
				value = EUU.ALDE_seats
				compare = greater_than_or_equals
			}
		}
		EUU = {
			set_politics = {	
				ruling_party = progressive
				elections_allowed = yes
			}
		}
	}
}

set_eurosceptic_commission = {
	if = {
		limit = {
			check_variable = {
				var = EUU.NI_seats
				value = EUU.APF_seats
				compare = greater_than_or_equals
			}
			check_variable = {
				var = EUU.NI_seats
				value = EUU.ID_seats
				compare = greater_than_or_equals
			}
			check_variable = {
				var = EUU.NI_seats
				value = EUU.ECR_seats
				compare = greater_than_or_equals
			}
			check_variable = {
				var = EUU.NI_seats
				value = EUU.GUE_NGL_seats
				compare = greater_than_or_equals
			}
			check_variable = {
				var = EUU.NI_seats
				value = EUU.INITIATIVE_seats
				compare = greater_than_or_equals
			}
		}
		EUU = {
			set_politics = {	
				ruling_party = islamist
				elections_allowed = yes
			}
		}
	}
	if = {
		limit = {
			check_variable = {
				var = EUU.APF_seats
				value = EUU.NI_seats
				compare = greater_than_or_equals
			}
			check_variable = {
				var = EUU.APF_seats
				value = EUU.ID_seats
				compare = greater_than_or_equals
			}
			check_variable = {
				var = EUU.APF_seats
				value = EUU.ECR_seats
				compare = greater_than_or_equals
			}
			check_variable = {
				var = EUU.APF_seats
				value = EUU.GUE_NGL_seats
				compare = greater_than_or_equals
			}
			check_variable = {
				var = EUU.APF_seats
				value = EUU.INITIATIVE_seats
				compare = greater_than_or_equals
			}
		}
		EUU = {
			set_politics = {	
				ruling_party = fascist
				elections_allowed = yes
			}
		}
	}
	if = {
		limit = {
			check_variable = {
				var = EUU.ID_seats
				value = EUU.APF_seats
				compare = greater_than_or_equals
			}
			check_variable = {
				var = EUU.ID_seats
				value = EUU.NI_seats
				compare = greater_than_or_equals
			}
			check_variable = {
				var = EUU.ID_seats
				value = EUU.ECR_seats
				compare = greater_than_or_equals
			}
			check_variable = {
				var = EUU.ID_seats
				value = EUU.GUE_NGL_seats
				compare = greater_than_or_equals
			}
			check_variable = {
				var = EUU.ID_seats
				value = EUU.INITIATIVE_seats
				compare = greater_than_or_equals
			}
		}
		EUU = {
			set_politics = {	
				ruling_party = right_wing_populist
				elections_allowed = yes
			}
		}
	}
	if = {
		limit = {
			check_variable = {
				var = EUU.ECR_seats
				value = EUU.APF_seats
				compare = greater_than_or_equals
			}
			check_variable = {
				var = EUU.ECR_seats
				value = EUU.NI_seats
				compare = greater_than_or_equals
			}
			check_variable = {
				var = EUU.ECR_seats
				value = EUU.ID_seats
				compare = greater_than_or_equals
			}
			check_variable = {
				var = EUU.ECR_seats
				value = EUU.GUE_NGL_seats
				compare = greater_than_or_equals
			}
			check_variable = {
				var = EUU.ECR_seats
				value = EUU.INITIATIVE_seats
				compare = greater_than_or_equals
			}
		}
		EUU = {
			set_politics = {	
				ruling_party = national_conservative
				elections_allowed = yes
			}
		}
	}
	if = {
		limit = {
			check_variable = {
				var = EUU.GUE_NGL_seats
				value = EUU.APF_seats
				compare = greater_than_or_equals
			}
			check_variable = {
				var = EUU.GUE_NGL_seats
				value = EUU.NI_seats
				compare = greater_than_or_equals
			}
			check_variable = {
				var = EUU.GUE_NGL_seats
				value = EUU.ID_seats
				compare = greater_than_or_equals
			}
			check_variable = {
				var = EUU.GUE_NGL_seats
				value = EUU.ECR_seats
				compare = greater_than_or_equals
			}
			check_variable = {
				var = EUU.GUE_NGL_seats
				value = EUU.INITIATIVE_seats
				compare = greater_than_or_equals
			}
		}
		EUU = {
			set_politics = {	
				ruling_party = socialist
				elections_allowed = yes
			}
		}
	}
	if = {
		limit = {
			check_variable = {
				var = EUU.INITIATIVE_seats
				value = EUU.APF_seats
				compare = greater_than_or_equals
			}
			check_variable = {
				var = EUU.INITIATIVE_seats
				value = EUU.NI_seats
				compare = greater_than_or_equals
			}
			check_variable = {
				var = EUU.INITIATIVE_seats
				value = EUU.ID_seats
				compare = greater_than_or_equals
			}
			check_variable = {
				var = EUU.INITIATIVE_seats
				value = EUU.ECR_seats
				compare = greater_than_or_equals
			}
			check_variable = {
				var = EUU.INITIATIVE_seats
				value = EUU.GUE_NGL_seats
				compare = greater_than_or_equals
			}
		}
		EUU = {
			set_politics = {	
				ruling_party = communist
				elections_allowed = yes
			}
		}
	}
}

puppet_ideology_cleanup = {
	if  = {
		limit = {
			NOT = { has_government = islamist }
			NOT = { has_country_flag = has_islamist_party }
		}
		add_popularity = { 
			ideology = islamist
			popularity = -1
		}
	}
	if  = {
		limit = {
			NOT = { has_government = fascist }
			NOT = { has_country_flag = has_fascist_party }
		}
		add_popularity = { 
			ideology = fascist
			popularity = -1
		}
	}
	if  = {
		limit = {
			NOT = { has_government = right_wing_populist }
			NOT = { has_country_flag = has_right_wing_populist_party }
		}
		add_popularity = { 
			ideology = right_wing_populist
			popularity = -1
		}
	}
	if  = {
		limit = {
			NOT = { has_government = monarchist }
			NOT = { has_country_flag = has_monarchist_party }
		}
		add_popularity = { 
			ideology = monarchist
			popularity = -1
		}
	}
	if  = {
		limit = {
			NOT = { has_government = national_conservative }
			NOT = { has_country_flag = has_national_conservative_party }
		}
		add_popularity = { 
			ideology = national_conservative
			popularity = -1
		}
	}
	if  = {
		limit = {
			NOT = { has_government = conservative }
			NOT = { has_country_flag = has_conservative_party }
		}
		add_popularity = { 
			ideology = conservative
			popularity = -1
		}
	}
	if  = {
		limit = {
			NOT = { has_government = classical_liberal }
			NOT = { has_country_flag = has_classical_liberal_party }
		}
		add_popularity = { 
			ideology = classical_liberal
			popularity = -1
		}
	}
	if  = {
		limit = {
			NOT = { has_government = social_liberal }
			NOT = { has_country_flag = has_social_liberal_party }
		}
		add_popularity = { 
			ideology = social_liberal
			popularity = -1
		}
	}
	if  = {
		limit = {
			NOT = { has_government = social_democrat }
			NOT = { has_country_flag = has_social_democrat_party }
		}
		add_popularity = { 
			ideology = social_democrat
			popularity = -1
		}
	}
	if  = {
		limit = {
			NOT = { has_government = progressive }
			NOT = { has_country_flag = has_progressive_party }
		}
		add_popularity = { 
			ideology = progressive
			popularity = -1
		}
	}
	if  = {
		limit = {
			NOT = { has_government = socialist }
			NOT = { has_country_flag = has_socialist_party }
		}
		add_popularity = { 
			ideology = socialist
			popularity = -1
		}
	}
	if  = {
		limit = {
			NOT = { has_government = communist }
			NOT = { has_country_flag = has_communist_party }
		}
		add_popularity = { 
			ideology = communist
			popularity = -1
		}
	}
}

puppet_government_sync = {
	if  = {
		limit = {
			FROM = {
				OR = {
					has_idea = parliamentary_system
					has_idea = presidential_republic
					has_idea = demarchic_republic
				}
			}
		}
		meta_effect = {
			text = {
				set_politics = {
					ruling_party = [RULINGPARTY]
					elections_allowed = yes
				}
			}
			RULINGPARTY = "[?ROOT.current_party_ideology_group.GetTokenKey]"
			debug = yes
		}
		if  = {
			limit = {
				FROM = { has_idea = presidential_republic }
			}
			add_ideas = presidential_republic
		}
		if  = {
			limit = {
				FROM = { has_idea = parliamentary_system }
			}
			add_ideas = parliamentary_system
		}
		if  = {
			limit = {
				FROM = { has_idea = demarchic_republic }
			}
			add_ideas = demarchic_republic
		}
	}
	if = {
		limit = {
			FROM = {
				OR = {
					has_idea = one_party_state
					has_idea = absolute_monarchy
				}
			}
		}
		meta_effect = {
			text = {
				set_politics = {
					ruling_party = [RULINGPARTY]
					elections_allowed = no
				}
			}
			RULINGPARTY = "[?ROOT.current_party_ideology_group.GetTokenKey]"
			debug = yes
		}
		if  = {
			limit = {
				FROM = { has_idea = absolute_monarchy }
			}
			add_ideas = absolute_monarchy
		}
		if  = {
			limit = {
				FROM = { has_idea = one_party_state }
			}
			add_ideas = one_party_state
		}
	}
	one_party_parliament = yes
}

auto_government = {
	if = {
		limit = {
			islamist_neighbor_coalition_plurality = yes
		}
		set_politics = {	
			ruling_party = islamist
			elections_allowed = yes
		}
		set_country_flag = coalition_islamist
		add_to_variable = { ROOT.Coalition = islamist_seats }
	}
	else_if = {
		limit = {
			fascist_neighbor_coalition_plurality = yes
			check_variable = { fascist_seats > right_wing_nationalist_seats }
		}
		set_politics = {	
			ruling_party = fascist
			elections_allowed = yes
		}
		set_country_flag = coalition_fascist
		add_to_variable = { ROOT.Coalition = fascist_seats }
		if = {
			limit = {
				check_variable = { right_wing_populist_seats > 0.01 }
				check_variable = { ROOT.Coalition < 50.01 }
			}
			set_country_flag = coalition_right_wing_populist
			add_to_variable = { ROOT.Coalition = right_wing_populist_seats }
		}
	}
	else_if = {
		limit = {
			right_wing_populist_neighbor_coalition_plurality = yes
			check_variable = { right_wing_populist_seats > fascist_seats }
			OR = {
				NOT = { national_conservative_neighbor_coalition_plurality = yes }
				check_variable = { right_wing_populist_seats > national_conservative_seats }
			}
		}
		set_politics = {
			ruling_party = right_wing_populist
			elections_allowed = yes
		}
		set_country_flag = coalition_right_wing_populist
		add_to_variable = { ROOT.Coalition = right_wing_populist_seats }
		if = {
			limit = {
				check_variable = { fascist_seats > 0.01 }
				check_variable = { ROOT.Coalition < 50.01 }
			}
			set_country_flag = coalition_fascist
			add_to_variable = { ROOT.Coalition = fascist_seats }
		}
		if = {
			limit = {
				check_variable = { national_conservative_seats > 0.01 }
				check_variable = { ROOT.Coalition < 50.01 }
			}
			set_country_flag = coalition_national_conservative
			add_to_variable = { ROOT.Coalition = national_conservative_seats }
		}
	}
	else_if = {
		limit = {
			national_conservative_neighbor_coalition_plurality = yes
			OR = {
				NOT = { right_wing_populist_neighbor_coalition_plurality = yes }
				check_variable = { national_conservative_seats > right_wing_populist_seats }
			}
			OR = {
				NOT = { conservative_neighbor_coalition_plurality = yes }
				check_variable = { national_conservative_seats > conservative_seats }
			}
		}
		set_politics = {	
			ruling_party = national_conservative
			elections_allowed = yes
		}
		set_country_flag = coalition_national_conservative
		add_to_variable = { ROOT.Coalition = national_conservative_seats }
		if = {
			limit = {
				check_variable = { right_wing_populist_seats > 0.01 }
				check_variable = { ROOT.Coalition < 50.01 }
			}
			set_country_flag = coalition_right_wing_populist
			add_to_variable = { ROOT.Coalition = right_wing_populist_seats }
		}
		if = {
			limit = {
				check_variable = { conservative_seats > 0.01 }
				check_variable = { ROOT.Coalition < 50.01 }
			}
			set_country_flag = coalition_conservative
			add_to_variable = { ROOT.Coalition = conservative_seats }
		}
	}
	else_if = {
		limit = {
			conservative_neighbor_coalition_plurality = yes
			OR = {
				NOT = { national_conservative_neighbor_coalition_plurality = yes }
				check_variable = { conservative_seats > national_conservative_seats }
			}
			OR = {
				NOT = { classical_liberal_neighbor_coalition_plurality = yes }
				check_variable = { conservative_seats > classical_liberal_seats }
			}
		}
		set_politics = {
			ruling_party = conservative
			elections_allowed = yes
		}
		set_country_flag = coalition_conservative
		add_to_variable = { ROOT.Coalition = conservative_seats }
		if = {
			limit = {
				check_variable = { classical_liberal_seats > 0.01 }
				check_variable = { ROOT.Coalition < 50.01 }
			}
			set_country_flag = coalition_classical_liberal
			add_to_variable = { ROOT.Coalition = classical_liberal_seats }
		}
		if = {
			limit = {
				check_variable = { national_conservative_seats > 0.01 }
				check_variable = { ROOT.Coalition < 50.01 }
			}
			set_country_flag = coalition_national_conservative
			add_to_variable = { ROOT.Coalition = national_conservative_seats }
		}
	}
	else_if = {
		limit = {
			classical_liberal_neighbor_coalition_plurality = yes
			OR = {
				NOT = { conservative_neighbor_coalition_plurality = yes }
				check_variable = { classical_liberal_seats > conservative_seats }
			}
			OR = {
				NOT = { social_liberal_neighbor_coalition_plurality = yes }
				check_variable = { classical_liberal_seats > social_liberal_seats }
			}
		}
		set_politics = {
			ruling_party = classical_liberal
			elections_allowed = yes
		}
		set_country_flag = coalition_classical_liberal
		add_to_variable = { ROOT.Coalition = classical_liberal_seats }
		if = {
			limit = {
				check_variable = { conservative_seats > 0.01 }
				check_variable = { ROOT.Coalition < 50.01 }
			}
			set_country_flag = coalition_conservative
			add_to_variable = { ROOT.Coalition = conservative_seats }
		}
		if = {
			limit = {
				check_variable = { social_liberal_seats > 0.01 }
				check_variable = { ROOT.Coalition < 50.01 }
			}
			set_country_flag = coalition_social_liberal
			add_to_variable = { ROOT.Coalition = social_liberal_seats }
		}
	}
	else_if = {
		limit = {
			social_liberal_neighbor_coalition_plurality = yes
			OR = {
				NOT = { social_democrat_neighbor_coalition_plurality = yes }
				check_variable = { social_liberal_seats > social_democrat_seats }
			}
			OR = {
				NOT = { classical_liberal_neighbor_coalition_plurality = yes }
				check_variable = { social_liberal_seats > classical_liberal_seats }
			}
		}
		set_politics = {
			ruling_party = social_liberal
			elections_allowed = yes
		}
		set_country_flag = coalition_social_liberal
		add_to_variable = { ROOT.Coalition = social_liberal_seats }
		if = {
			limit = {
				check_variable = { classical_liberal_seats > 0.01 }
				check_variable = { ROOT.Coalition < 50.01 }
			}
			set_country_flag = coalition_classical_liberal
			add_to_variable = { ROOT.Coalition = classical_liberal_seats }
		}
		if = {
			limit = {
				check_variable = { social_democrat_seats > 0.01 }
				check_variable = { ROOT.Coalition < 50.01 }
			}
			set_country_flag = coalition_social_democrat
			add_to_variable = { ROOT.Coalition = social_democrat_seats }
		}
	}
	else_if = {
		limit = {
			social_democrat_neighbor_coalition_plurality = yes
			OR = {
				NOT = { social_liberal_neighbor_coalition_plurality = yes }
				check_variable = { social_democrat_seats > social_liberal_seats }
			}
			OR = {
				NOT = { progressive_neighbor_coalition_plurality = yes }
				check_variable = { social_democrat_seats > progressive_seats }
			}
		}
		set_politics = {
			ruling_party = social_democrat
			elections_allowed = yes
		}
		set_country_flag = coalition_social_democrat
		add_to_variable = { ROOT.Coalition = social_democrat_seats }
		if = {
			limit = {
				check_variable = { progressive_seats > 0.01 }
				check_variable = { ROOT.Coalition < 50.01 }
			}
			set_country_flag = coalition_progressive
			add_to_variable = { ROOT.Coalition = progressive_seats }
		}
		if = {
			limit = {
				check_variable = { social_liberal_seats > 0.01 }
				check_variable = { ROOT.Coalition < 50.01 }
			}
			set_country_flag = coalition_social_liberal
			add_to_variable = { ROOT.Coalition = social_liberal_seats }
		}
	}
	else_if = {
		limit = {
			progressive_neighbor_coalition_plurality = yes
			OR = {
				NOT = { social_democrat_neighbor_coalition_plurality = yes }
				check_variable = { progressive_seats > social_democrat_seats }
			}
			OR = {
				NOT = { socialist_neighbor_coalition_plurality = yes }
				check_variable = { progressive_seats > socialist_seats }
			}
		}
		set_politics = {
			ruling_party = progressive
			elections_allowed = yes
		}
		set_country_flag = coalition_progressive
		add_to_variable = { ROOT.Coalition = progressive_seats }
		if = {
			limit = {
				check_variable = { social_democrat_seats > 0.01 }
				check_variable = { ROOT.Coalition < 50.01 }
			}
			set_country_flag = coalition_social_democrat
			add_to_variable = { ROOT.Coalition = social_democrat_seats }
		}
		if = {
			limit = {
				check_variable = { socialist_seats > 0.01 }
				check_variable = { ROOT.Coalition < 50.01 }
			}
			set_country_flag = coalition_socialist
			add_to_variable = { ROOT.Coalition = socialist_seats }
		}
	}
	else_if = {
		limit = {
			socialist_neighbor_coalition_plurality = yes
			OR = {
				NOT = { progressive_neighbor_coalition_plurality = yes }
				check_variable = { socialist_seats > progressive_seats }
			}
			check_variable = { socialist_seats > communist_seats }
		}
		set_politics = {
			ruling_party = socialist
			elections_allowed = yes
		}
		set_country_flag = coalition_socialist
		add_to_variable = { ROOT.Coalition = socialist_seats }
		if = {
			limit = {
				check_variable = { progressive_seats > 0.01 }
				check_variable = { ROOT.Coalition < 50.01 }
			}
			set_country_flag = coalition_progressive
			add_to_variable = { ROOT.Coalition = progressive_seats }
		}
		if = {
			limit = {
				check_variable = { communist_seats > 0.01 }
				check_variable = { ROOT.Coalition < 50.01 }
			}
			set_country_flag = coalition_communist
			add_to_variable = { ROOT.Coalition = communist_seats }
		}
	}
	else_if = {
		limit = {
			communist_neighbor_coalition_plurality = yes
			check_variable = { communist_seats > socialist_seats }
		}
		set_politics = {
			ruling_party = communist
			elections_allowed = yes
		}
		set_country_flag = coalition_communist
		add_to_variable = { ROOT.Coalition = communist_seats }
		if = {
			limit = {
				check_variable = { socialist_seats > 0.01 }
				check_variable = { ROOT.Coalition < 50.01 }
			}
			set_country_flag = coalition_socialist
			add_to_variable = { ROOT.Coalition = socialist_seats }
		}
	}
	set_parliament_graphics = yes
	post_election_effects = yes
}

gubernatorial_elections = {
	set_temp_variable = { islamist_popularity = party_popularity@islamist }
	set_temp_variable = { fascist_popularity = party_popularity@fascist }
	set_temp_variable = { right_wing_populist_popularity = party_popularity@right_wing_populist }
	set_temp_variable = { monarchist_popularity = party_popularity@monarchist }
	set_temp_variable = { national_conservative_popularity = party_popularity@national_conservative }
	set_temp_variable = { conservative_popularity = party_popularity@conservative }
	set_temp_variable = { classical_liberal_popularity = party_popularity@classical_liberal }
	set_temp_variable = { social_liberal_popularity = party_popularity@social_liberal }
	set_temp_variable = { social_democrat_popularity = party_popularity@social_democrat }
	set_temp_variable = { progressive_popularity = party_popularity@progressive }
	set_temp_variable = { socialist_popularity = party_popularity@socialist }
	set_temp_variable = { communist_popularity = party_popularity@communist }
	every_owned_state = {
		clear_state_government_flags = yes
	}
	every_owned_state = {
		limit = {
			is_core_of = ROOT
			NOT = {
				is_capital = yes
			}
		}
		random_list = {
			islamist_popularity = {
				set_state_flag = state_government_islamist
			}
			fascist_popularity = {
				set_state_flag = state_government_fascist
			}
			right_wing_populist_popularity = {
				set_state_flag = state_government_right_wing_populist
			}
			monarchist_popularity = {
				set_state_flag = state_government_monarchist
			}
			national_conservative_popularity = {
				set_state_flag = state_government_national_conservative
			}
			conservative_popularity = {
				set_state_flag = state_government_conservative
			}
			classical_liberal_popularity = {
				set_state_flag = state_government_classical_liberal
			}
			social_liberal_popularity = {
				set_state_flag = state_government_social_liberal
			}
			social_democrat_popularity = {
				set_state_flag = state_government_social_democrat
			}
			progressive_popularity = {
				set_state_flag = state_government_progressive
			}
			socialist_popularity = {
				set_state_flag = state_government_socialist
			}
			communist_popularity = {
				set_state_flag = state_government_communist
			}
		}
	}
}

clear_state_government_flags = {
	clr_state_flag = state_government_islamist
	clr_state_flag = state_government_fascist
	clr_state_flag = state_government_right_wing_populist
	clr_state_flag = state_government_monarchist
	clr_state_flag = state_government_national_conservative
	clr_state_flag = state_government_conservative
	clr_state_flag = state_government_classical_liberal
	clr_state_flag = state_government_social_liberal
	clr_state_flag = state_government_social_democrat
	clr_state_flag = state_government_progressive
	clr_state_flag = state_government_socialist
	clr_state_flag = state_government_communist
}

set_old_election_results = {
	set_variable = { old_islamist = islamist_seats }
	set_variable = { old_fascist = fascist_seats }
	set_variable = { old_right_wing_populist = right_wing_populist_seats }
	set_variable = { old_monarchist = monarchist_seats }
	set_variable = { old_national_conservative = national_conservative_seats }
	set_variable = { old_conservative = conservative_seats }
	set_variable = { old_classical_liberal = classical_liberal_seats }
	set_variable = { old_social_liberal = social_liberal_seats }
	set_variable = { old_social_democrat = social_democrat_seats }
	set_variable = { old_progressive = progressive_seats }
	set_variable = { old_socialist = socialist_seats }
	set_variable = { old_communist = communist_seats }
}

set_election_change = {
	set_variable = { islamist_election_change = islamist_seats }
	subtract_from_variable = {
		var = islamist_election_change
		value = old_islamist
	}
	set_variable = { fascist_election_change = fascist_seats }
	subtract_from_variable = {
		var = fascist_election_change
		value = old_fascist
	}
	set_variable = { right_wing_populist_election_change = right_wing_populist_seats }
	subtract_from_variable = {
		var = right_wing_populist_election_change
		value = old_right_wing_populist
	}
	set_variable = { monarchist_election_change = monarchist_seats }
	subtract_from_variable = {
		var = monarchist_election_change
		value = old_monarchist
	}
	set_variable = { national_conservative_election_change = national_conservative_seats }
	subtract_from_variable = {
		var = national_conservative_election_change
		value = old_national_conservative
	}
	set_variable = { conservative_election_change = conservative_seats }
	subtract_from_variable = {
		var = conservative_election_change
		value = old_conservative
	}
	set_variable = { classical_liberal_election_change = classical_liberal_seats }
	subtract_from_variable = {
		var = classical_liberal_election_change
		value = old_classical_liberal
	}
	set_variable = { social_liberal_election_change = social_liberal_seats }
	subtract_from_variable = {
		var = social_liberal_election_change
		value = old_social_liberal
	}
	set_variable = { social_democrat_election_change = social_democrat_seats }
	subtract_from_variable = {
		var = social_democrat_election_change
		value = old_social_democrat
	}
	set_variable = { progressive_election_change = progressive_seats }
	subtract_from_variable = {
		var = progressive_election_change
		value = old_progressive
	}
	set_variable = { socialist_election_change = socialist_seats }
	subtract_from_variable = {
		var = socialist_election_change
		value = old_socialist
	}
	set_variable = { communist_election_change = communist_seats }
	subtract_from_variable = {
		var = communist_election_change
		value = old_communist
	}
}

set_neighbor_coalition_values = {
	set_variable = { fascist_neighbor_coalition = 0 }
	set_variable = { right_wing_populist_neighbor_coalition = 0 }
	set_variable = { national_conservative_neighbor_coalition = 0 }
	set_variable = { conservative_neighbor_coalition = 0 }
	set_variable = { classical_liberal_neighbor_coalition = 0 }
	set_variable = { social_liberal_neighbor_coalition = 0 }
	set_variable = { social_democrat_neighbor_coalition = 0 }
	set_variable = { progressive_neighbor_coalition = 0 }
	set_variable = { socialist_neighbor_coalition = 0 }
	set_variable = { communist_neighbor_coalition = 0 }
	add_to_variable = { fascist_neighbor_coalition = fascist_seats }
	add_to_variable = { fascist_neighbor_coalition = right_wing_populist_seats }
	add_to_variable = { right_wing_populist_neighbor_coalition = fascist_seats }
	add_to_variable = { right_wing_populist_neighbor_coalition = right_wing_populist_seats }
	add_to_variable = { right_wing_populist_neighbor_coalition = national_conservative_seats }
	add_to_variable = { national_conservative_neighbor_coalition = right_wing_populist_seats }
	add_to_variable = { national_conservative_neighbor_coalition = national_conservative_seats }
	add_to_variable = { national_conservative_neighbor_coalition = conservative_seats }
	add_to_variable = { conservative_neighbor_coalition = national_conservative_seats }
	add_to_variable = { conservative_neighbor_coalition = conservative_seats }
	add_to_variable = { conservative_neighbor_coalition = classical_liberal_seats }
	add_to_variable = { classical_liberal_neighbor_coalition = conservative_seats }
	add_to_variable = { classical_liberal_neighbor_coalition = classical_liberal_seats }
	add_to_variable = { social_liberal_neighbor_coalition = classical_liberal_seats }
	add_to_variable = { social_liberal_neighbor_coalition = social_liberal_seats }
	add_to_variable = { social_liberal_neighbor_coalition = social_democrat_seats }
	add_to_variable = { social_democrat_neighbor_coalition = social_liberal_seats }
	add_to_variable = { social_democrat_neighbor_coalition = social_democrat_seats }
	add_to_variable = { social_democrat_neighbor_coalition = progressive_seats }
	add_to_variable = { progressive_neighbor_coalition = social_democrat_seats }
	add_to_variable = { progressive_neighbor_coalition = progressive_seats }
	add_to_variable = { progressive_neighbor_coalition = socialist_seats }
	add_to_variable = { socialist_neighbor_coalition = progressive_seats }
	add_to_variable = { socialist_neighbor_coalition = socialist_seats }
	add_to_variable = { socialist_neighbor_coalition = communist_seats }
	add_to_variable = { communist_neighbor_coalition = socialist_seats }
	add_to_variable = { communist_neighbor_coalition = communist_seats }
	if = {
		limit = {
			check_variable = { fascist_seats < 1 }
		}
		set_variable = { fascist_neighbor_coalition = 0 }
	}
	if = {
		limit = {
			check_variable = { right_wing_populist_seats < 1 }
		}
		set_variable = { right_wing_populist_neighbor_coalition = 0 }
	}
	if = {
		limit = {
			check_variable = { national_conservative_seats < 1 }
		}
		set_variable = { national_conservative_neighbor_coalition = 0 }
	}
	if = {
		limit = {
			check_variable = { conservative_seats < 1 }
		}
		set_variable = { conservative_neighbor_coalition = 0 }
	}
	if = {
		limit = {
			check_variable = { classical_liberal_seats < 1 }
		}
		set_variable = { classical_liberal_neighbor_coalition = 0 }
	}
	if = {
		limit = {
			check_variable = { social_liberal_seats < 1 }
		}
		set_variable = { social_liberal_neighbor_coalition = 0 }
	}
	if = {
		limit = {
			check_variable = { social_democrat_seats < 1 }
		}
		set_variable = { social_democrat_neighbor_coalition = 0 }
	}
	if = {
		limit = {
			check_variable = { progressive_seats < 1 }
		}
		set_variable = { progressive_neighbor_coalition = 0 }
	}
	if = {
		limit = {
			check_variable = { socialist_seats < 1 }
		}
		set_variable = { socialist_neighbor_coalition = 0 }
	}
	if = {
		limit = {
			check_variable = { communist_seats < 1 }
		}
		set_variable = { communist_neighbor_coalition = 0 }
	}
}

parliament_math_failsafe = {
	hidden_effect = {
		set_variable = { parliament_math_failsafe = 100 }
		subtract_from_variable = { parliament_math_failsafe = communist_seats }
		subtract_from_variable = { parliament_math_failsafe = socialist_seats }
		subtract_from_variable = { parliament_math_failsafe = progressive_seats }
		subtract_from_variable = { parliament_math_failsafe = social_democrat_seats }
		subtract_from_variable = { parliament_math_failsafe = social_liberal_seats }
		subtract_from_variable = { parliament_math_failsafe = classical_liberal_seats }
		subtract_from_variable = { parliament_math_failsafe = conservative_seats }
		subtract_from_variable = { parliament_math_failsafe = national_conservative_seats }
		subtract_from_variable = { parliament_math_failsafe = monarchist_seats }
		subtract_from_variable = { parliament_math_failsafe = right_wing_populist_seats }
		subtract_from_variable = { parliament_math_failsafe = fascist_seats }
		subtract_from_variable = { parliament_math_failsafe = islamist_seats }
		if = {
			limit = {
				classical_liberal_plurality_popularity = yes
			}
			add_to_variable = { classical_liberal_seats = parliament_math_failsafe }
		}
		else_if = {
			limit = {
				social_liberal_plurality_popularity = yes
			}
			add_to_variable = { social_liberal_seats = parliament_math_failsafe }
		}
		else_if = {
			limit = {
				social_democrat_plurality_popularity = yes
			}
			add_to_variable = { social_democrat_seats = parliament_math_failsafe }
		}
		else_if = {
			limit = {
				conservative_plurality_popularity = yes
			}
			add_to_variable = { conservative_seats = parliament_math_failsafe }
		}
		else_if = {
			limit = {
				progressive_plurality_popularity = yes
			}
			add_to_variable = { progressive_seats = parliament_math_failsafe }
		}
		else_if = {
			limit = {
				national_conservative_plurality_popularity = yes
			}
			add_to_variable = { national_conservative_seats = parliament_math_failsafe }
		}
		else_if = {
			limit = {
				socialist_plurality_popularity = yes
			}
			add_to_variable = { socialist_seats = parliament_math_failsafe }
		}
		else_if = {
			limit = {
				right_wing_populist_plurality_popularity = yes
			}
			add_to_variable = { right_wing_populist_seats = parliament_math_failsafe }
		}
		else_if = {
			limit = {
				communist_plurality_popularity = yes
			}
			add_to_variable = { communist_seats = parliament_math_failsafe }
		}
		else_if = {
			limit = {
				fascist_plurality_popularity = yes
			}
			add_to_variable = { fascist_seats = parliament_math_failsafe }
		}
		else_if = {
			limit = {
				islamist_plurality_popularity = yes
			}
			add_to_variable = { islamist_seats = parliament_math_failsafe }
		}
		else = {
			add_to_variable = { monarchist_seats = parliament_math_failsafe }
		}
	}
}

set_coalition_seats = {
	set_variable = { ROOT.Coalition = 0 }
	if = {
		limit = {
			has_country_flag = coalition_communist
		}
		add_to_variable = { ROOT.Coalition = communist_seats }
	}
	if = {
		limit = {
			has_country_flag = coalition_socialist
		}
		add_to_variable = { ROOT.Coalition = socialist_seats }
	}
	if = {
		limit = {
			has_country_flag = coalition_progressive
		}
		add_to_variable = { ROOT.Coalition = progressive_seats }
	}
	if = {
		limit = {
			has_country_flag = coalition_social_democrat
		}
		add_to_variable = { ROOT.Coalition = social_democrat_seats }
	}
	if = {
		limit = {
			has_country_flag = coalition_social_liberal
		}
		add_to_variable = { ROOT.Coalition = social_liberal_seats }
	}
	if = {
		limit = {
			has_country_flag = coalition_classical_liberal
		}
		add_to_variable = { ROOT.Coalition = classical_liberal_seats }
	}
	if = {
		limit = {
			has_country_flag = coalition_conservative
		}
		add_to_variable = { ROOT.Coalition = conservative_seats }
	}
	if = {
		limit = {
			has_country_flag = coalition_national_conservative
		}
		add_to_variable = { ROOT.Coalition = national_conservative_seats }
	}
	if = {
		limit = {
			has_country_flag = coalition_monarchist
		}
		add_to_variable = { ROOT.Coalition = monarchist_seats }
	}
	if = {
		limit = {
			has_country_flag = coalition_right_wing_populist
		}
		add_to_variable = { ROOT.Coalition = right_wing_populist_seats }
	}
	if = {
		limit = {
			has_country_flag = coalition_fascist
		}
		add_to_variable = { ROOT.Coalition = fascist_seats }
	}
	if = {
		limit = {
			has_country_flag = coalition_islamist
		}
		add_to_variable = { ROOT.Coalition = islamist_seats }
	}
	set_variable = {
		ROOT.Opposition = 100
	}
	subtract_from_variable = {
		ROOT.Opposition = ROOT.Coalition
	}
}